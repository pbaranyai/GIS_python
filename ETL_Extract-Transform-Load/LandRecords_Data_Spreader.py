# ---------------------------------------------------------------------------
# LandRecords_Data_Spreader.py
# Created on: 2019-03-05 
# Updated on 2021-09-21
#
# Author: Phil Baranyai/GIS Manager
#
# Description: 
#  Update the following FC from source data to CRAW_INTERNAL -> PUBLIC_WEB as needed:
#
# ADDR_UNIT_TBL  
# ADDRESS_POINTS
# ADDRESS_POINTS_WEB_RELATE
# BUILDING_ONLY
# ID_POINT 
# SOFTLINES
# STREET_CENTERLINES
# TAX_PARCELS
#
#   All processes have general components, delete rows, append from another source - due to most layers are connected to services
# ---------------------------------------------------------------------------

# Import modules
import sys
import arcpy
import datetime
import os
import logging

# Stop geoprocessing log history in metadata (stops program from filling up geoprocessing history in metadata with every run)
arcpy.SetLogHistory(False)

# Setup error logging (configure logging location, type, and filemode -- overwrite every run)
logfile = r"\\FILELOCATION\\GIS\\GIS_LOGS\\LandRecords_Data_Spreader.log"  
logging.basicConfig(filename= logfile, filemode='w', level=logging.DEBUG)

# Setup Date (and day/time)
date = datetime.date.today().strftime("%Y%m%d")
Day = time.strftime("%m-%d-%Y", time.localtime())
Time = time.strftime("%I:%M:%S %p", time.localtime())

try:
    # Write Logfile
    def write_log(text, file):
        f = open(file, 'a')           # 'a' will append to an existing file if it exists
        f.write("{}\n".format(text))  # write the text to the logfile and move to next line
        return
except:
    print ("\n Unable to write log file")
    write_log("Unable to write log file", logfile)
    sys.exit ()

#Database Connection Folder
Database_Connections = r"\\\FILELOCATION\\GIS\\ArcAutomations\\Database_Connections"
 
# Database variables:
AST = Database_Connections + "\\AST@ccsde.sde"
AUTOWORKSPACE = Database_Connections + "\\auto_workspace@ccsde.sde"
AUTOWORKSPACE_AST = Database_Connections + "\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment"
CRAW_INTERNAL = Database_Connections + "\\craw_internal@ccsde.sde"
PUBLIC_SAFETY = Database_Connections + "\\PUBLIC_SAFETY@ccsde.sde"
PUBLIC_WEB = Database_Connections + "\\public_web@ccsde.sde"

# Local variables:
ADDR_UNIT_TBL_PUBLIC_SAFETY = PUBLIC_SAFETY + "\\CCSDE.PUBLIC_SAFETY.SSAP_UNIT_TBL"
ADDR_UNIT_TBL_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.SSAP_UNIT_TBL_INTERNAL"
ADDR_UNIT_TBL_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.SSAP_UNIT_TBL_WEB"
ADDRESS_POINTS_PUBLIC_SAFETY = PUBLIC_SAFETY + "\\CCSDE.PUBLIC_SAFETY.Land_Records\\CCSDE.PUBLIC_SAFETY.Site_Structure_Address_Points"
ADDRESS_POINTS_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.Site_Structure_Address_Points_INTERNAL"
ADDRESS_POINTS_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.Site_Structure_Address_Points_WEB"
ADDRESS_POINTS_WEB_RELATE = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Boundaries\\CCSDE.PUBLIC_WEB.SiteStructureAddressPoints_Web_Relate"
ADDRESS_ACCESS_PUBLIC_SAFETY = PUBLIC_SAFETY + "\\CCSDE.PUBLIC_SAFETY.ADDRESS_ACCESS_LINES"
ADDRESS_ACCESS_CRAW_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.ADDRESS_ACCESS_LINES"
AIRPARCELS_AUTOWKSP = AUTOWORKSPACE_AST + "\\CCSDE.AUTO_WORKSPACE.TaxParcel_Air_Joined"
AIRPARCELS_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.TaxParcel_Air_INTERNAL"
AIRPARCELS_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.TaxParcel_Air_WEB"
##BUILDING_ONLY_AUTOWKSP = AUTOWORKSPACE_AST + "\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined"
##BUILDING_ONLY_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.BUILDING_ONLY_JOINED_INTERNAL"
##BUILDING_ONLY_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.BUILDING_ONLY_JOINED_WEB"
ID_POINT_AST = AST + "\\AST.Crawford_Parcels\\AST.ID_Point"
ID_POINT_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL"
ID_POINT_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.ID_POINT_WEB"
SOFTLINES_AST = AST + "\\AST.Crawford_Parcels\\AST.Softlines"
SOFTLINES_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.SOFTLINES_INTERNAL"
SOFTLINES_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.SOFTLINES_WEB"
STREET_CENTERLINE_PUBLIC_SAFETY = PUBLIC_SAFETY + "\\CCSDE.PUBLIC_SAFETY.Land_Records\\CCSDE.PUBLIC_SAFETY.Street_Centerlines"
STREET_CENTERLINE_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.Street_Centerlines_INTERNAL"
STREET_CENTERLINE_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.Street_Centerlines_WEB"
TAX_PARCELS_AUTOWKSP = AUTOWORKSPACE_AST + "\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined"
TAX_PARCELS_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.TAX_PARCELS_INTERNAL"
TAX_PARCELS_WEB = PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.Land_Records\\CCSDE.PUBLIC_WEB.TAX_PARCELS_WEB"
VIS_REALMAST_TBL_AUTOWKSP = AUTOWORKSPACE + "\\CCSDE.AUTO_WORKSPACE.VIS_REALMAST_TBL"
VISION_OWNER_TBL_AUTOWKSP = AUTOWORKSPACE + "\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL"
VISION_OWNER_TBL_INTERNAL = CRAW_INTERNAL + "\\CCSDE.CRAW_INTERNAL.VISION_OWNER_TBL_INTERNAL"
VISION_OWNER_TBL_WEB =  PUBLIC_WEB + "\\CCSDE.PUBLIC_WEB.VISION_OWNER_TBL_WEB"
VISION_OWNER_TBL_WEBTemp = AUTOWORKSPACE + "\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp"

start_time = time.time()

print ("============================================================================")
print (("Updating Land Records: "+ str(Day) + " " + str(Time)))
print ("Will update the following:")
print ("\nAddress Units Table")
print ("Address Points Feature Class")
print ("Address Points Web Relate Feature Class")
print ("Building/Trailer Only Feature Class")
print ("ID Point Feature Class")
print ("Softlines Feature Class")
print ("Street Centerline Feature Class")
print ("Tax Parcel Feature Class")
print ("Tax Parcel - Air Feature Class")
print ("\n From source to CRAW_INTERNAL -> PUBLIC_WEB (where applicable)")
print ("Works in ArcGIS Pro")
print ("============================================================================")

write_log("============================================================================", logfile)
write_log("Updating Land Records: "+ str(Day) + " " + str(Time), logfile)
write_log("Will update the following:", logfile)
write_log("\nAddress Units Table", logfile)  
write_log("Address Points Feature Class", logfile)
write_log("Address Points Web Relate Feature Class", logfile) 
write_log("Building/Trailer Only Feature Class", logfile)
write_log("ID Point Feature Class", logfile) 
write_log("Softlines Feature Class", logfile)
write_log("Street Centerline Feature Class", logfile)
write_log("Tax Parcel Feature Class", logfile)
write_log("Tax Parcel - Air Feature Class", logfile)
write_log("\n From source to CRAW_INTERNAL -> PUBLIC_WEB -> PUBLIC_OD (where applicable)", logfile)
write_log("Works in ArcGIS Pro", logfile)
write_log("============================================================================", logfile)

print ("\n Updating Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY")
write_log("\n Updating Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY: " + str(Day) + " " + str(Time), logfile)

try:
    # Delete rows from Street Centerline - CRAW_INTERNAL
    arcpy.DeleteRows_management(STREET_CENTERLINE_INTERNAL)
except:
    print ("\n Unable to delete rows from Street Centerline - CRAW_INTERNAL")
    write_log("Unable to delete rows from Street Centerline - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Street Centerline - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:    
    # Append Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY
    arcpy.management.Append(STREET_CENTERLINE_PUBLIC_SAFETY, STREET_CENTERLINE_INTERNAL, "NO_TEST", r'CL_UniqueID "Unique ID" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',CL_UniqueID,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',DateUpdate,-1,-1;DateAdded "Date record was added" true true false 8 Date 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',DateAdded,-1,-1;RCL_NGUID "Road Centerline NENA Globaly Unique ID" true true false 254 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',RCL_NGUID,0,254;FromAddr_L "Left FROM Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',FromAddr_L,-1,-1;ToAddr_L "Left TO Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ToAddr_L,-1,-1;FromAddr_R "Right FROM Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',FromAddr_R,-1,-1;ToAddr_R "Right TO Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ToAddr_R,-1,-1;Parity_L "Parity Left" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',Parity_L,0,1;Parity_R "Parity Right" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',Parity_R,0,1;ParityAll "Parity of centerline segment" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ParityAll,0,1;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',St_Name,0,60;St_PostTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',St_PostTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',St_FullName,0,160;ESN_L "ESN Left" true true false 5 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ESN_L,0,5;ESN_R "ESN Right" true true false 5 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ESN_R,0,5;Country_L "Country Left" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',Country_L,0,2;Country_R "Country Right" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',Country_R,0,2;State_L "State Left" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',State_L,0,2;State_R "State Right" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',State_R,0,2;County_L "County Left" true true false 40 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',County_L,0,40;County_R "County Right" true true false 40 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',County_R,0,40;County_R_FIPS "County FIPS Code Right" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',County_R_FIPS,-1,-1;County_L_FIPS "County FIPS Code Left" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',County_L_FIPS,-1,-1;IncMuni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',IncMuni,0,100;IncMuni_L "Incorporated Municipality Left" true true false 100 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',IncMuni_L,0,100;IncMuni_R "Incorporated Municipality Right" true true false 100 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',IncMuni_R,0,100;IncMuniFIPS_L "Incorporated Municipality FIPS Code Left" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',IncMuniFIPS_L,-1,-1;IncMuniFIPS_R "Incorporated Municipality FIPS Code Right" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',IncMuniFIPS_R,-1,-1;OneWay "One Way" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',OneWay,0,2;SpeedLimit "Speed Limit (MPH)" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',SpeedLimit,-1,-1;TF_RoutingCost "To-From Routing Cost" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',TF_RoutingCost,-1,-1;FT_RoutingCost "From-To Routing Cost" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',FT_RoutingCost,-1,-1;RouteNumber "Route Number" true true false 25 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',RouteNumber,0,25;LegislativeRouteNumber "Legislative Route Number" true true false 30 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',LegislativeRouteNumber,0,30;AddressCount "# of addresses assigned to segment" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',AddressCount,-1,-1;AddressRange "Address Range assigned to segment" true true false 15 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',AddressRange,0,15;Tile "Grid Tile ID" true true false 10 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',Tile,0,10;ZElev_F "Z Elevation From" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ZElev_F,-1,-1;ZElev_T "Z Elevation To" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ZElev_T,-1,-1;ConstructionStatus "Construction Status" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',ConstructionStatus,-1,-1;MaintenanceOwner "Maintenance Owner" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',MaintenanceOwner,-1,-1;SurfaceType "Surface Type" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',SurfaceType,-1,-1;WeightLimit "Weight Limit (Tons)" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',WeightLimit,-1,-1;HeightLimit "Height Limit (Feet)" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',HeightLimit,-1,-1;Divided "Is roadway divded?" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',Divided,0,1;OverWater "Is segment over water?" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',OverWater,0,1;InCounty "Is segment within Crawford County?" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',InCounty,0,1;CFCC "Census Feature Class Code" true true false 6 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',CFCC,0,6;MTFCC "Map/Tiger Feature Class Code" true true false 6 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',MTFCC,0,6;F_CrossStreet "FROM Cross Street" true true false 160 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',F_CrossStreet,0,160;T_CrossStreet "TO Cross Street" true true false 160 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',T_CrossStreet,0,160;UpdateCode "Update Code" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',UpdateCode,-1,-1;UpdateUser "UpdateUser" true true false 75 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',UpdateUser,0,75;RoadClass "Road Classification" true true false 255 Text 0 0,First,#,'+STREET_CENTERLINE_PUBLIC_SAFETY+',RoadClass,0,255;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#', '', '')
    Centerline_Internal_result = arcpy.GetCount_management(STREET_CENTERLINE_INTERNAL)
    print (('{} has {} records'.format(STREET_CENTERLINE_INTERNAL, Centerline_Internal_result[0])))
    write_log('{} has {} records'.format(STREET_CENTERLINE_INTERNAL, Centerline_Internal_result[0]), logfile)
except:
    print ("\n Unable to append Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY")
    write_log("Unable to append Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY", logfile)
    logging.exception('Got exception on append Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Street Centerline - CRAW_INTERNAL from PUBLIC_SAFETY completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Street Centerline - PUBLIC_WEB from CRAW_INTERNAL - filtering out CONST_STATUS = 1")
write_log("\n Updating Street Centerline - PUBLIC_WEB from CRAW_INTERNAL - filtering out CONST_STATUS = 1", logfile)

try:
    # Delete rows from Street Centerline - PUBLIC_WEB
    arcpy.DeleteRows_management(STREET_CENTERLINE_WEB)
except:
    print ("\n Unable to delete rows from Street Centerline - PUBLIC_WEB")
    write_log("Unable to delete rows from Street Centerline - PUBLIC_WEB", logfile)
    logging.exception('Got exception on Unable to delete rows from Street Centerline - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append street centerline layer to Street Centerline - PUBLIC_WEB (filtered to Construction status is not equal to PLAT_RECORDED)
    arcpy.management.Append(STREET_CENTERLINE_INTERNAL, STREET_CENTERLINE_WEB, "NO_TEST", r'CL_UniqueID "Unique ID" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_INTERNAL+',CL_UniqueID,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',DateUpdate,-1,-1;DateAdded "Date record was added" true true false 8 Date 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',DateAdded,-1,-1;RCL_NGUID "Road Centerline NENA Globaly Unique ID" true true false 254 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',RCL_NGUID,0,254;FromAddr_L "Left FROM Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_INTERNAL+',FromAddr_L,-1,-1;ToAddr_L "Left TO Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_INTERNAL+',ToAddr_L,-1,-1;FromAddr_R "Right FROM Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_INTERNAL+',FromAddr_R,-1,-1;ToAddr_R "Right TO Address" true true false 4 Long 0 10,First,#,'+STREET_CENTERLINE_INTERNAL+',ToAddr_R,-1,-1;Parity_L "Parity Left" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',Parity_L,0,1;Parity_R "Parity Right" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',Parity_R,0,1;ParityAll "Parity of centerline segment" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',ParityAll,0,1;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',St_Name,0,60;St_PostTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',St_PostTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',St_FullName,0,160;ESN_L "ESN Left" true true false 5 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',ESN_L,0,5;ESN_R "ESN Right" true true false 5 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',ESN_R,0,5;Country_L "Country Left" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',Country_L,0,2;Country_R "Country Right" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',Country_R,0,2;State_L "State Left" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',State_L,0,2;State_R "State Right" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',State_R,0,2;County_L "County Left" true true false 40 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',County_L,0,40;County_R "County Right" true true false 40 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',County_R,0,40;County_R_FIPS "County FIPS Code Right" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',County_R_FIPS,-1,-1;County_L_FIPS "County FIPS Code Left" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',County_L_FIPS,-1,-1;IncMuni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',IncMuni,0,100;IncMuni_L "Incorporated Municipality Left" true true false 100 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',IncMuni_L,0,100;IncMuni_R "Incorporated Municipality Right" true true false 100 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',IncMuni_R,0,100;IncMuniFIPS_L "Incorporated Municipality FIPS Code Left" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',IncMuniFIPS_L,-1,-1;IncMuniFIPS_R "Incorporated Municipality FIPS Code Right" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',IncMuniFIPS_R,-1,-1;OneWay "One Way" true true false 2 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',OneWay,0,2;SpeedLimit "Speed Limit (MPH)" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_INTERNAL+',SpeedLimit,-1,-1;TF_RoutingCost "To-From Routing Cost" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',TF_RoutingCost,-1,-1;FT_RoutingCost "From-To Routing Cost" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',FT_RoutingCost,-1,-1;RouteNumber "Route Number" true true false 25 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',RouteNumber,0,25;LegislativeRouteNumber "Legislative Route Number" true true false 30 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',LegislativeRouteNumber,0,30;AddressCount "# of addresses assigned to segment" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_INTERNAL+',AddressCount,-1,-1;AddressRange "Address Range assigned to segment" true true false 15 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',AddressRange,0,15;Tile "Grid Tile ID" true true false 10 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',Tile,0,10;ZElev_F "Z Elevation From" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',ZElev_F,-1,-1;ZElev_T "Z Elevation To" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',ZElev_T,-1,-1;ConstructionStatus "Construction Status" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',ConstructionStatus,-1,-1;MaintenanceOwner "Maintenance Owner" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',MaintenanceOwner,-1,-1;SurfaceType "Surface Type" true true false 8 Double 8 38,First,#,'+STREET_CENTERLINE_INTERNAL+',SurfaceType,-1,-1;WeightLimit "Weight Limit (Tons)" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_INTERNAL+',WeightLimit,-1,-1;HeightLimit "Height Limit (Feet)" true true false 2 Short 0 5,First,#,'+STREET_CENTERLINE_INTERNAL+',HeightLimit,-1,-1;Divided "Is roadway divded?" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',Divided,0,1;OverWater "Is segment over water?" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',OverWater,0,1;InCounty "Is segment within Crawford County?" true true false 1 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',InCounty,0,1;CFCC "Census Feature Class Code" true true false 6 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',CFCC,0,6;MTFCC "Map/Tiger Feature Class Code" true true false 6 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',MTFCC,0,6;F_CrossStreet "FROM Cross Street" true true false 160 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',F_CrossStreet,0,160;T_CrossStreet "TO Cross Street" true true false 160 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',T_CrossStreet,0,160;RoadClass "Road Classification" true true false 255 Text 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',RoadClass,0,255;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#,'+STREET_CENTERLINE_INTERNAL+',GlobalID,-1,-1', '', "ConstructionStatus <> 1")
    Centerline_Web_result = arcpy.GetCount_management(STREET_CENTERLINE_WEB)
    print (('{} has {} records'.format(STREET_CENTERLINE_WEB, Centerline_Web_result[0])))
    write_log('{} has {} records'.format(STREET_CENTERLINE_WEB, Centerline_Web_result[0]), logfile)
except:
    print ("\n Unable to append street centerline layer to Street Centerline - PUBLIC_WEB")
    write_log("Unable to append street centerline layer to Street Centerline - PUBLIC_WEB", logfile)
    logging.exception('Got exception on append street centerline layer to Street Centerline - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Street Centerline - PUBLIC_WEB from CRAW_INTERNAL - filtering out CONST_STATUS = 1 completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Street Centerline - PUBLIC_WEB from CRAW_INTERNAL - filtering out CONST_STATUS = 1 completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Address Points - CRAW_INTERNAL from PUBLIC_SAFETY")
write_log("\n Updating Address Points - CRAW_INTERNAL from PUBLIC_SAFETY", logfile)

try:
    # Delete rows from Address Points FC - CRAW_INTERNAL
    arcpy.DeleteRows_management(ADDRESS_POINTS_INTERNAL)
except:
    print ("\n Unable to delete rows from Address Points FC - CRAW_INTERNAL")
    write_log("Unable to delete rows from Address Points FC - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Address Points FC - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:    
    # Append Address Points FC - CRAW_INTERNAL from PUBLIC_SAFETY
    arcpy.management.Append(ADDRESS_POINTS_PUBLIC_SAFETY, ADDRESS_POINTS_INTERNAL, "NO_TEST", r'UniqueStructureNumber "Unique Structure Number" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',UniqueStructureNumber,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',DateUpdate,-1,-1;Effective "Date record added" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Effective,-1,-1;Expire "Temporary address expiration date" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Expire,-1,-1;Site_NGUID "Site NENA Globally Unique ID" true true false 254 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Site_NGUID,0,254;Country "Country" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Country,0,2;Inc_Muni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Inc_Muni,0,100;Inc_Muni_FIPS "Incorporated Municipality FIPS Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Inc_Muni_FIPS,-1,-1;Add_Number "Address Number" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Add_Number,-1,-1;AddNum_Suf "Address Number Suffix" true true false 15 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',AddNum_Suf,0,15;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',St_Name,0,60;St_PosTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',St_PosTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',St_FullName,0,160;FullAddress "House # & Street" true true false 200 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',FullAddress,0,200;ESN "Emergency Service Number" true true false 2 Short 0 5,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',ESN,-1,-1;Post_Box "Current PO Box # (if applicable)" true true false 7 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Post_Box,0,7;Post_Comm "Postal Community Name" true true false 40 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Post_Comm,0,40;Post_Code "Postal Code" true true false 255 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Post_Code,0,255;Building "Building" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Building,0,75;Floor "Floor" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Floor,0,75;Unit "Unit" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Unit,0,75;Room "Room" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Room,0,75;Elevation "Elevation" true true false 4 Long 0 10,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Elevation,-1,-1;LastName "Last Name or Business Name" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',LastName,0,150;FirstName "First Name" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',FirstName,0,150;Old_RRType "Old Rural Route Type" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Old_RRType,0,2;Old_RRNumber "Old Rural Route #" true true false 5 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Old_RRNumber,0,5;Old_RRBox "Old Rural Route Box #" true true false 7 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Old_RRBox,0,7;State "State" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',State,0,2;AddrType "Address Type" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',AddrType,-1,-1;CountyFIPS "County FIPS Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',CountyFIPS,-1,-1;CountyName "County Name" true true false 50 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',CountyName,0,50;NumberOfUnits "Number of units" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',NumberOfUnits,-1,-1;UpdateCode "Update Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',UpdateCode,-1,-1;Editor "Last record editor" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Editor,0,150;PublicExempt "Is record exempt from public?" true true false 1 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',PublicExempt,0,1;Old_Address "Former 911 address (if applicable)" true true false 160 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Old_Address,0,160;Old_Address_Problem "Former 911 address issue" true true false 255 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',Old_Address_Problem,0,255;AddressChange_Accepted "Has address change been accepted?" true true false 1 Text 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',AddressChange_Accepted,0,1;AddressChange_Date "Date address was changed" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_PUBLIC_SAFETY+',AddressChange_Date,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#', '', '')
    AddressPoint_Internal_result = arcpy.GetCount_management(ADDRESS_POINTS_INTERNAL)
    print (('{} has {} records'.format(ADDRESS_POINTS_INTERNAL, AddressPoint_Internal_result[0])))
    write_log('{} has {} records'.format(ADDRESS_POINTS_INTERNAL, AddressPoint_Internal_result[0]), logfile)
except:
    print ("\n Unable to append Address Points FC - CRAW_INTERNAL from PUBLIC_SAFETY")
    write_log("Unable to append Address Points FC - CRAW_INTERNAL from PUBLIC_SAFETY", logfile)
    logging.exception('Got exception on append Address Points FC - CRAW_INTERNAL from PUBLIC_SAFETY logged at:' + str(Day) + " " + str(Time))
    raise
    sys.exit ()

print ("       Updating Address Points - CRAW_INTERNAL from PUBLIC_SAFETY completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Address Points - CRAW_INTERNAL from PUBLIC_SAFETY completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Address Points - PUBLIC_WEB from CRAW_INTERNAL - filtering out AD_PUB_EXEMPT LIKE N")
write_log("\n Updating Address Points - PUBLIC_WEB from CRAW_INTERNAL - filtering out AD_PUB_EXEMPT LIKE N", logfile)

try:
    # Delete rows from Address Points - PUBLIC_WEB
    arcpy.DeleteRows_management(ADDRESS_POINTS_WEB)
except:
    print ("\n Unable to delete rows from Address Points - PUBLIC_WEB")
    write_log("Unable to delete rows from Address Points - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from Address Points - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Update Address Points - PUBLIC_WEB from filtered layer file from CRAW_INTERNAL (filtering out public exempt = Y)
    arcpy.management.Append(ADDRESS_POINTS_INTERNAL, ADDRESS_POINTS_WEB, "NO_TEST", r'UniqueStructureNumber "Unique Structure Number" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',UniqueStructureNumber,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',DateUpdate,-1,-1;Effective "Date record added" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Effective,-1,-1;Expire "Temporary address expiration date" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Expire,-1,-1;Site_NGUID "Site NENA Globally Unique ID" true true false 254 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Site_NGUID,0,254;Country "Country" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Country,0,2;Inc_Muni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Inc_Muni,0,100;Inc_Muni_FIPS "Incorporated Municipality FIPS Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',Inc_Muni_FIPS,-1,-1;Add_Number "Address Number" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',Add_Number,-1,-1;AddNum_Suf "Address Number Suffix" true true false 15 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',AddNum_Suf,0,15;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',St_Name,0,60;St_PosTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',St_PosTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',St_FullName,0,160;FullAddress "House # & Street" true true false 200 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',FullAddress,0,200;ESN "Emergency Service Number" true true false 2 Short 0 5,First,#,'+ADDRESS_POINTS_INTERNAL+',ESN,-1,-1;Post_Box "Current PO Box # (if applicable)" true true false 7 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Post_Box,0,7;Post_Comm "Postal Community Name" true true false 40 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Post_Comm,0,40;Post_Code "Postal Code" true true false 255 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Post_Code,0,255;Building "Building" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Building,0,75;Floor "Floor" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Floor,0,75;Unit "Unit" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Unit,0,75;Room "Room" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Room,0,75;Elevation "Elevation" true true false 4 Long 0 10,First,#,'+ADDRESS_POINTS_INTERNAL+',Elevation,-1,-1;LastName "Last Name or Business Name" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',LastName,0,150;FirstName "First Name" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',FirstName,0,150;Old_RRType "Old Rural Route Type" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Old_RRType,0,2;Old_RRNumber "Old Rural Route #" true true false 5 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Old_RRNumber,0,5;Old_RRBox "Old Rural Route Box #" true true false 7 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Old_RRBox,0,7;State "State" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',State,0,2;AddrType "Address Type" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',AddrType,-1,-1;CountyFIPS "County FIPS Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',CountyFIPS,-1,-1;CountyName "County Name" true true false 50 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',CountyName,0,50;NumberOfUnits "Number of units" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',NumberOfUnits,-1,-1;UpdateCode "Update Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_INTERNAL+',UpdateCode,-1,-1;Old_Address "Former 911 address (if applicable)" true true false 160 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',Old_Address,0,160;AddressChange_Accepted "Has address change been accepted?" true true false 1 Text 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',AddressChange_Accepted,0,1;AddressChange_Date "Date address was changed" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',AddressChange_Date,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#,'+ADDRESS_POINTS_INTERNAL+',GlobalID,-1,-1', '', "PublicExempt = 'N'")
    AddressPoint_Web_result = arcpy.GetCount_management(ADDRESS_POINTS_WEB)
    print (('{} has {} records'.format(ADDRESS_POINTS_WEB, AddressPoint_Web_result[0])))
    write_log('{} has {} records'.format(ADDRESS_POINTS_WEB, AddressPoint_Web_result[0]), logfile)
except:
    print ("\n Unable to update Address Points - PUBLIC_WEB from filtered layer file from CRAW_INTERNAL")
    write_log("Unable to update Address Points - PUBLIC_WEB from filtered layer file from CRAW_INTERNAL", logfile)
    logging.exception('Got exception on update Address Points - PUBLIC_WEB from filtered layer file from CRAW_INTERNAL logged at:' + str(Day) + " " + str(Time))
    raise
    sys.exit ()

print ("       Updating Address Points - PUBLIC_WEB from CRAW_INTERNAL - filtering out AD_PUB_EXEMPT LIKE N completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Address Points - PUBLIC_WEB from CRAW_INTERNAL - filtering out AD_PUB_EXEMPT LIKE N completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating CRAW_INTERNAL Apartment/Suite Unit table from PUBLIC_SAFETY")
write_log("\n Updating CRAW_INTERNAL Apartment/Suite Unit table from PUBLIC_SAFETY", logfile)

try:
    # Delete rows from Address Unit TBL - CRAW_INTERNAL
    arcpy.DeleteRows_management(ADDR_UNIT_TBL_INTERNAL)
except:
    print ("\n Unable to delete rows from Address Unit TBL - CRAW_INTERNAL")
    write_log("Unable to delete rows from Address Unit TBL - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Address Unit TBL - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append Address Unit TBL - CRAW_INTERNAL from PUBLIC_SAFETY
    arcpy.management.Append(ADDR_UNIT_TBL_PUBLIC_SAFETY, ADDR_UNIT_TBL_INTERNAL, "NO_TEST", r'UniqueStructureNumber "Unique Structure Number" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',UniqueStructureNumber,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',DateUpdate,-1,-1;Effective "Date record added" true true false 8 Date 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Effective,-1,-1;Expire "Temporary address expiration date" true true false 8 Date 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Expire,-1,-1;Site_NGUID "Site NENA Globally Unique ID" true true false 254 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Site_NGUID,0,254;Country "Country" true true false 2 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Country,0,2;Inc_Muni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Inc_Muni,0,100;Inc_Muni_FIPS "Incorporated Municipality FIPS Code" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Inc_Muni_FIPS,-1,-1;Add_Number "Address Number" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Add_Number,-1,-1;AddNum_Suf "Address Number Suffix" true true false 15 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',AddNum_Suf,0,15;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',St_Name,0,60;St_PosTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',St_PosTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',St_FullName,0,160;FullAddress "House # & Street" true true false 200 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',FullAddress,0,200;ESN "Emergency Service Number" true true false 2 Short 0 5,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',ESN,-1,-1;Post_Box "Current PO Box # (if applicable)" true true false 7 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Post_Box,0,7;Post_Comm "Postal Community Name" true true false 40 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Post_Comm,0,40;Post_Code "Postal Code" true true false 255 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Post_Code,0,255;Building "Building" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Building,0,75;Floor "Floor" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Floor,0,75;Unit "Unit" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Unit,0,75;Room "Room" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Room,0,75;Elevation "Elevation" true true false 4 Long 0 10,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Elevation,-1,-1;LastName "Business Name" true true false 150 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',LastName,0,150;State "State" true true false 2 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',State,0,2;AddrType "Address Type" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',AddrType,-1,-1;CountyFIPS "County FIPS Code" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',CountyFIPS,-1,-1;CountyName "County Name" true true false 50 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',CountyName,0,50;UpdateCode "Update Code" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',UpdateCode,-1,-1;Editor "Last record editor" true true false 150 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Editor,0,150;Internal_Comments "Comments/Notes (internal use only)" true true false 255 Text 0 0,First,#,'+ADDR_UNIT_TBL_PUBLIC_SAFETY+',Internal_Comments,0,255;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#', '', '')
    AddressUnitTBL_Internal_result = arcpy.GetCount_management(ADDR_UNIT_TBL_INTERNAL)
    print (('{} has {} records'.format(ADDR_UNIT_TBL_INTERNAL,  AddressUnitTBL_Internal_result[0])))
    write_log('{} has {} records'.format(ADDR_UNIT_TBL_INTERNAL,  AddressUnitTBL_Internal_result[0]), logfile)
except:
    print ("\n Unable to append Address Unit TBL - CRAW_INTERNAL from PUBLIC_SAFETY")
    write_log("Unable to append Address Unit TBL - CRAW_INTERNAL from PUBLIC_SAFETY", logfile)
    logging.exception('Got exception on append Address Unit TBL - CRAW_INTERNAL from PUBLIC_SAFETY logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Address Unit TBL - CRAW_INTERNAL from PUBLIC_SAFETY completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Address Unit TBL - CRAW_INTERNAL from PUBLIC_SAFETY completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)
    
print ("\n Updating Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL")
write_log("\n Updating Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL", logfile)

try:
    # Delete rows from Address Unit TBL - PUBLIC_WEB
    arcpy.DeleteRows_management(ADDR_UNIT_TBL_WEB)
except:
    print ("\n Unable to delete rows from Address Unit TBL - PUBLIC_WEB")
    write_log("Unable to delete rows from Address Unit TBL - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from Address Unit TBL - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL
    arcpy.management.Append(ADDR_UNIT_TBL_INTERNAL, ADDR_UNIT_TBL_WEB, "NO_TEST", r'UniqueStructureNumber "Unique Structure Number" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_INTERNAL+',UniqueStructureNumber,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',DateUpdate,-1,-1;Effective "Date record added" true true false 8 Date 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Effective,-1,-1;Expire "Temporary address expiration date" true true false 8 Date 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Expire,-1,-1;Site_NGUID "Site NENA Globally Unique ID" true true false 254 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Site_NGUID,0,254;Country "Country" true true false 2 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Country,0,2;Inc_Muni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Inc_Muni,0,100;Inc_Muni_FIPS "Incorporated Municipality FIPS Code" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Inc_Muni_FIPS,-1,-1;Add_Number "Address Number" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Add_Number,-1,-1;AddNum_Suf "Address Number Suffix" true true false 15 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',AddNum_Suf,0,15;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',St_Name,0,60;St_PosTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',St_PosTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',St_FullName,0,160;FullAddress "House # & Street" true true false 200 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',FullAddress,0,200;ESN "Emergency Service Number" true true false 2 Short 0 5,First,#,'+ADDR_UNIT_TBL_INTERNAL+',ESN,-1,-1;Post_Box "Current PO Box # (if applicable)" true true false 7 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Post_Box,0,7;Post_Comm "Postal Community Name" true true false 40 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Post_Comm,0,40;Post_Code "Postal Code" true true false 255 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Post_Code,0,255;Building "Building" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Building,0,75;Floor "Floor" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Floor,0,75;Unit "Unit" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Unit,0,75;Room "Room" true true false 75 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Room,0,75;Elevation "Elevation" true true false 4 Long 0 10,First,#,'+ADDR_UNIT_TBL_INTERNAL+',Elevation,-1,-1;LastName "Business Name" true true false 150 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',LastName,0,150;State "State" true true false 2 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',State,0,2;AddrType "Address Type" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_INTERNAL+',AddrType,-1,-1;CountyFIPS "County FIPS Code" true true false 8 Double 8 38,First,#,'+ADDR_UNIT_TBL_INTERNAL+',CountyFIPS,-1,-1;CountyName "County Name" true true false 50 Text 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',CountyName,0,50;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#,'+ADDR_UNIT_TBL_INTERNAL+',GlobalID,-1,-1', '', '')
    AddressUnitTBL_Web_result = arcpy.GetCount_management(ADDR_UNIT_TBL_WEB)
    print (('{} has {} records'.format(ADDR_UNIT_TBL_WEB,  AddressUnitTBL_Web_result[0])))
    write_log('{} has {} records'.format(ADDR_UNIT_TBL_WEB,  AddressUnitTBL_Web_result[0]), logfile)
except:
    print ("\n Unable to append Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL")
    write_log("Unable to append Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL", logfile)
    logging.exception('Got exception on append Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Address Unit TBL - PUBLIC_WEB from CRAW_INTERNAL completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB")
write_log("\n Updating Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB", logfile)

try:
    # Delete rows from Address Points Web Relate FC - PUBLIC_WEB
    arcpy.DeleteRows_management(ADDRESS_POINTS_WEB_RELATE)
except:
    print ("\n Unable to delete rows from Address Points Web Relate FC - PUBLIC_WEB")
    write_log("Unable to delete rows from Address Points Web Relate FC - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from Address Points Web Relate FC - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:    
    # Append Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB
    arcpy.management.Append(ADDRESS_POINTS_WEB, ADDRESS_POINTS_WEB_RELATE, "NO_TEST", r'UniqueStructureNumber "Unique Structure Number" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',UniqueStructureNumber,-1,-1;DiscrpAgID "Discrepancy Agency ID" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',DiscrpAgID,0,75;DateUpdate "Date record last updated" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_WEB+',DateUpdate,-1,-1;Effective "Date record added" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_WEB+',Effective,-1,-1;Expire "Temporary address expiration date" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_WEB+',Expire,-1,-1;Site_NGUID "Site NENA Globally Unique ID" true true false 254 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Site_NGUID,0,254;Country "Country" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Country,0,2;Inc_Muni "Incorporated Municipality" true true false 100 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Inc_Muni,0,100;Inc_Muni_FIPS "Incorporated Municipality FIPS Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',Inc_Muni_FIPS,-1,-1;Add_Number "Address Number" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',Add_Number,-1,-1;AddNum_Suf "Address Number Suffix" true true false 15 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',AddNum_Suf,0,15;St_PreDir "Street Name Pre Directional" true true false 9 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',St_PreDir,0,9;St_Name "Street Name" true true false 60 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',St_Name,0,60;St_PosTyp "Street Name Post Type" true true false 50 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',St_PosTyp,0,50;St_PosDir "Street Name Post Directional" true true false 9 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',St_PosDir,0,9;St_FullName "Street Full Name" true true false 160 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',St_FullName,0,160;FullAddress "House # & Street" true true false 200 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',FullAddress,0,200;ESN "Emergency Service Number" true true false 2 Short 0 5,First,#,'+ADDRESS_POINTS_WEB+',ESN,-1,-1;Post_Box "Current PO Box # (if applicable)" true true false 7 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Post_Box,0,7;Post_Comm "Postal Community Name" true true false 40 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Post_Comm,0,40;Post_Code "Postal Code" true true false 255 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Post_Code,0,255;Building "Building" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Building,0,75;Floor "Floor" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Floor,0,75;Unit "Unit" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Unit,0,75;Room "Room" true true false 75 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Room,0,75;Elevation "Elevation" true true false 4 Long 0 10,First,#,'+ADDRESS_POINTS_WEB+',Elevation,-1,-1;LastName "Last Name or Business Name" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',LastName,0,150;FirstName "First Name" true true false 150 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',FirstName,0,150;Old_RRType "Old Rural Route Type" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Old_RRType,0,2;Old_RRNumber "Old Rural Route #" true true false 5 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Old_RRNumber,0,5;Old_RRBox "Old Rural Route Box #" true true false 7 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Old_RRBox,0,7;State "State" true true false 2 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',State,0,2;AddrType "Address Type" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',AddrType,-1,-1;CountyFIPS "County FIPS Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',CountyFIPS,-1,-1;CountyName "County Name" true true false 50 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',CountyName,0,50;NumberOfUnits "Number of units" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',NumberOfUnits,-1,-1;UpdateCode "Update Code" true true false 8 Double 8 38,First,#,'+ADDRESS_POINTS_WEB+',UpdateCode,-1,-1;Old_Address "Former 911 address (if applicable)" true true false 160 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',Old_Address,0,160;AddressChange_Accepted "Has address change been accepted?" true true false 1 Text 0 0,First,#,'+ADDRESS_POINTS_WEB+',AddressChange_Accepted,0,1;AddressChange_Date "Date address was changed" true true false 8 Date 0 0,First,#,'+ADDRESS_POINTS_WEB+',AddressChange_Date,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#,'+ADDRESS_POINTS_WEB+',GlobalID,-1,-1', '', '')
    AddressPoint_WebRelate_result = arcpy.GetCount_management(ADDRESS_POINTS_WEB_RELATE)
    print (('{} has {} records'.format(ADDRESS_POINTS_WEB_RELATE, AddressPoint_WebRelate_result[0])))
    write_log('{} has {} records'.format(ADDRESS_POINTS_WEB_RELATE, AddressPoint_WebRelate_result[0]), logfile)
except:
    print ("\n Unable to append Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB")
    write_log("Unable to append Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB", logfile)
    logging.exception('Got exception on append Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Address Points FC - PUBLIC_WEB from Address Points Web Relate FC - PUBLIC_WEB completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Address Access Lines - CRAW_INTERNAL from PUBLIC_SAFETY")
write_log("\n Updating Address Access Lines - CRAW_INTERNAL from PUBLIC_SAFETY", logfile)

try:
    # Delete rows from Address Access Lines - CRAW_INTERNAL
    arcpy.DeleteRows_management(ADDRESS_ACCESS_CRAW_INTERNAL)
except:
    print ("\n Unable to delete rows from Address Access Lines - CRAW_INTERNAL")
    write_log("Unable to delete rows from Address Access Lines - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Address Access Lines - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:    
    # Append Address Access Lines - CRAW_INTERNAL from Address Access Lines - PUBLIC_SAFETY
    arcpy.management.Append(ADDRESS_ACCESS_PUBLIC_SAFETY, ADDRESS_ACCESS_CRAW_INTERNAL, "NO_TEST", r'STRU_NUM "STRU_NUM" true true false 8 Double 8 38,First,#,'+ADDRESS_ACCESS_PUBLIC_SAFETY+',STRU_NUM,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0,First,#', '', '')
    Address_Access_result = arcpy.GetCount_management(ADDRESS_POINTS_WEB_RELATE)
    print (('{} has {} records'.format(ADDRESS_ACCESS_CRAW_INTERNAL, Address_Access_result[0])))
    write_log('{} has {} records'.format(ADDRESS_ACCESS_CRAW_INTERNAL, Address_Access_result[0]), logfile)
except:
    print ("\n Unable to append Address Access Lines - CRAW_INTERNAL from Address Access Lines - PUBLIC_SAFETY")
    write_log("Unable to append Address Access Lines - CRAW_INTERNAL from Address Access Lines - PUBLIC_SAFETY", logfile)
    logging.exception('Got exception on append Address Access Lines - CRAW_INTERNAL from Address Access Lines - PUBLIC_SAFETY logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Address Access Lines - CRAW_INTERNAL from PUBLIC_SAFETY completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Address Access Lines - CRAW_INTERNAL from PUBLIC_SAFETY completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
write_log("\n Updating Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)

try:
    # Delete rows from tax parcels - CRAW_INTERNAL
    arcpy.DeleteRows_management(TAX_PARCELS_INTERNAL)
except:
    print ("\n Unable to delete rows from Tax parcels - CRAW_INTERNAL")
    write_log("Unable to delete rows from Tax parcels - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Tax parcels - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT
    arcpy.Append_management(TAX_PARCELS_AUTOWKSP, TAX_PARCELS_INTERNAL, "NO_TEST", 'CAMA_PIN "MBLU (Map Block Lot Unit)" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,CAMA_PIN,-1,-1;MAP "Map" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAP,-1,-1;PARCEL "Parcel" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PARCEL,-1,-1;LOT "Lot" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LOT,-1,-1;PLANS_AVAILABLE "Plans Available" true true false 5 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PLANS_AVAILABLE,-1,-1;SEC_MUNI_NAME "Municipal Name" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MUNI_NAME,-1,-1;PID "PID Number" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PID,-1,-1;REM_PID "PID Number" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PID,-1,-1;REM_PIN "UPI Number" true true false 35 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PIN,-1,-1;REM_OWN_NAME "Owner Name" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_OWN_NAME,-1,-1;REM_PRCL_LOCN "Parcel Location" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PRCL_LOCN,-1,-1;REM_PRCL_LOCN_CITY "Parcel Location City" true true false 18 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PRCL_LOCN_CITY,-1,-1;REM_PRCL_LOCN_STT "Parcel Location State" true true false 2 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PRCL_LOCN_STT,-1,-1;REM_PRCL_LOCN_ZIP "Parcel Location Zipcode" true true false 12 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PRCL_LOCN_ZIP,-1,-1;REM_ALT_PRCL_ID "Old IBM Number" true true false 35 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_ALT_PRCL_ID,-1,-1;REM_PRCL_STATUS_DATE "Parcel Status date - CAMA Software" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_PRCL_STATUS_DATE,-1,-1;REM_MBLU_MAP "Map" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_MAP,-1,-1;REM_MBLU_MAP_CUT "Map Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_MAP_CUT,-1,-1;REM_MBLU_BLOCK "Block" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_BLOCK,-1,-1;REM_MBLU_BLOCK_CUT "Block Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_BLOCK_CUT,-1,-1;REM_MBLU_LOT "Lot" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_LOT,-1,-1;REM_MBLU_LOT_CUT "Lot Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_LOT_CUT,-1,-1;REM_MBLU_UNIT "Unit" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_UNIT,-1,-1;REM_MBLU_UNIT_CUT "Unit Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_MBLU_UNIT_CUT,-1,-1;REM_STATUS_DATE "Status Date - CAMA software" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_STATUS_DATE,-1,-1;REM_INET_SUPPRESS "Internet Suppression" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_INET_SUPPRESS,-1,-1;REM_IS_CONDO_MAIN "Is Condo Main Parcel" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_IS_CONDO_MAIN,-1,-1;REM_CMPLX_NAME "Complex Name" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_CMPLX_NAME,-1,-1;REM_BLDG_NAME "Acreage and Description" true true false 60 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_BLDG_NAME,-1,-1;REM_USE_CODE "Use Code" true true false 4 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_USE_CODE,-1,-1;REM_LEGAL_AREA "Legal Area" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_LEGAL_AREA,-1,-1;REM_LAST_UPDATE "Last Update - CAMA software" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_LAST_UPDATE,-1,-1;REM_USRFLD "6 digit PID" true true false 6 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_USRFLD,-1,-1;REM_USRFLD_DESC "Control Number" true true false 40 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,REM_USRFLD_DESC,-1,-1;PID_TEXT "PID Text format" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PID_TEXT,-1,-1;LND_USE_CODE "Land Use Code" true true false 4 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LND_USE_CODE,-1,-1;LND_USE_DESC "Land Use Description" true true false 40 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LND_USE_DESC,-1,-1;LND_DSTRCT "District Number" true true false 6 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LND_DSTRCT,-1,-1;PRC_PF_LOCN "School District Code" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_PF_LOCN,-1,-1;PRC_PF_LOCN_DESC "School District" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_PF_LOCN_DESC,-1,-1;PRC_USRFLD_09 "User Field 9 - Not Used" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_USRFLD_09,-1,-1;PRC_USRFLD_10 "User Field 10 - Not Used" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_USRFLD_10,-1,-1;PRC_TTL_ASSESS_BLDG "Total Building Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_TTL_ASSESS_BLDG,-1,-1;PRC_TTL_ASSESS_IMPROVEMENTS "Total Improvements Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_TTL_ASSESS_IMPROVEMENTS,-1,-1;PRC_TTL_ASSESS_LND "Total Land Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_TTL_ASSESS_LND,-1,-1;PRC_TTL_ASSESS_OB "Total Out Building Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_TTL_ASSESS_OB,-1,-1;PRC_VALUE "Parcel Value" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_VALUE,-1,-1;PRC_CMPLX_PID "Complex PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_CMPLX_PID,-1,-1;PRC_CMPLX_DESC "Complex Description" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_CMPLX_DESC,-1,-1;PRC_CENSUS "Census - Not Used" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_CENSUS,-1,-1;PRC_TTL_MRKT_ASSESS "Total Market Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_TTL_MRKT_ASSESS,-1,-1;PRC_TTL_ASSESS "Total Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,PRC_TTL_ASSESS,-1,-1;OWN_ID "OWN_ID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,OWN_ID,-1,-1;OWN_NAME1 "OWN_NAME1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,OWN_NAME1,-1,-1;OWN_NAME2 "OWN_NAME2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,OWN_NAME2,-1,-1;ROW_PID "ROW_PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,ROW_PID,-1,-1;ROW_OWN_PCT "ROW_OWN_PCT" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,ROW_OWN_PCT,-1,-1;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_NAME1,-1,-1;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_NAME2,-1,-1;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_ADDR1,-1,-1;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_CITY,-1,-1;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_STATE,-1,-1;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_ZIP,-1,-1;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,MAD_MAIL_ADDR2,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SLH_PID,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SLH_BOOK,-1,-1;SLH_PAGE "Deed Page" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SLH_PAGE,-1,-1;SLH_PRICE "Sale Price" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SLH_PRICE,-1,-1;SLH_CURRENT_OWNER "Sales History Current Owner Designation" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SLH_CURRENT_OWNER,-1,-1;GIS_ACRES "GIS Calculated Acres - not legal" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,GIS_ACRES,-1,-1;LANDEX_URL "Landex URL" true true false 600 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LANDEX_URL,-1,-1;GlobalID "GlobalID" false false true 38 GlobalID 0 0 ,First,#;LONGITUDE_X "Longitude_X" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LONGITUDE_X,-1,-1;LATITUDE_Y "Latitude_Y" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,LATITUDE_Y,-1,-1;SHAPE.STArea() "SHAPE.STArea()" false false true 0 Double 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SHAPE.STArea(),-1,-1;SHAPE.STLength() "SHAPE.STLength()" false false true 0 Double 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Tax_Parcels_Joined,SHAPE.STLength(),-1,-1', "")
    TaxParcel_Internal_result = arcpy.GetCount_management(TAX_PARCELS_INTERNAL)
    print (('{} has {} records'.format(TAX_PARCELS_INTERNAL,  TaxParcel_Internal_result[0])))
    write_log('{} has {} records'.format(TAX_PARCELS_INTERNAL,  TaxParcel_Internal_result[0]), logfile)  
except:
    print ("\n Unable to append Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
    write_log("Unable to append Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)
    logging.exception('Got exception on append Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Tax parcels - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
write_log("\n Updating VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)

try:
    # Delete rows from VISION_OWNER_TBL_INTERNAL
    arcpy.DeleteRows_management(VISION_OWNER_TBL_INTERNAL)
except:
    print ("\n Unable to delete rows from VISION_OWNER_TBL_INTERNAL")
    write_log("Unable to delete rows from VISION_OWNER_TBL_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from VISION_OWNER_TBL_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append rows from VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT
    arcpy.Append_management(VISION_OWNER_TBL_AUTOWKSP, VISION_OWNER_TBL_INTERNAL, "NO_TEST", 'OWN_NAME1 "Owner Name 1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,OWN_NAME1,-1,-1;OWN_NAME2 "Owner Name 2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,OWN_NAME2,-1,-1;ROW_PID "PID Number" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,ROW_PID,-1,-1;ROW_OWN_PCT "Percentage of Ownership" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,ROW_OWN_PCT,-1,-1;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_NAME1,-1,-1;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_NAME2,-1,-1;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_ADDR1,-1,-1;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_CITY,-1,-1;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_STATE,-1,-1;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_ZIP,-1,-1;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,MAD_MAIL_ADDR2,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,SLH_PID,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,SLH_BOOK,-1,-1;SLH_PAGE "Deed Page" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,SLH_PAGE,-1,-1;SLH_PRICE "Sale Price" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,SLH_PRICE,-1,-1;REM_INET_SUPPRESS "Internet Suppression" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL,REM_INET_SUPPRESS,-1,-1;GlobalID "GlobalID" false false true 38 GlobalID 0 0 ,First,#', "")
    OwnerTbl_Internal_result = arcpy.GetCount_management(VISION_OWNER_TBL_INTERNAL)
    print (('{} has {} records'.format(VISION_OWNER_TBL_INTERNAL,  OwnerTbl_Internal_result[0])))
    write_log('{} has {} records'.format(VISION_OWNER_TBL_INTERNAL,  OwnerTbl_Internal_result[0]), logfile)  
except:
    print ("\n Unable to append append rows from VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
    write_log("Unable to append rows from VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)
    logging.exception('Got exception on append rows from VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)   

print ("\n Updating Tax parcels - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
write_log("\n Updating Tax parcels - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", logfile)

try:
    # Delete rows from Tax parcels - PUBLIC_WEB
    arcpy.DeleteRows_management(TAX_PARCELS_WEB)
except:
    print ("\n Unable to delete rows from Tax parcels - PUBLIC_WEB")
    write_log("Unable to delete rows from Tax parcels - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from Tax parcels - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Make feature layer from Tax parcel - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 (make temporary layer in memory, filtering out REM_INET_SUPPRESS not = to 1, as they are allowed to be legally redacted from the public web)
    Tax_Parcel_Not_INET_SUPRESSED = arcpy.MakeFeatureLayer_management(TAX_PARCELS_INTERNAL, "Tax_Parcel_Not_INET_SUPRESSED", "REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", "", "CAMA_PIN CAMA_PIN VISIBLE NONE;MAP MAP VISIBLE NONE;PARCEL PARCEL VISIBLE NONE;LOT LOT VISIBLE NONE;PLANS_AVAILABLE PLANS_AVAILABLE VISIBLE NONE;SEC_MUNI_NAME SEC_MUNI_NAME VISIBLE NONE;PID PID VISIBLE NONE;REM_PID REM_PID VISIBLE NONE;REM_PIN REM_PIN VISIBLE NONE;REM_OWN_NAME REM_OWN_NAME VISIBLE NONE;REM_PRCL_LOCN REM_PRCL_LOCN VISIBLE NONE;REM_PRCL_LOCN_CITY REM_PRCL_LOCN_CITY VISIBLE NONE;REM_PRCL_LOCN_STT REM_PRCL_LOCN_STT VISIBLE NONE;REM_PRCL_LOCN_ZIP REM_PRCL_LOCN_ZIP VISIBLE NONE;REM_ALT_PRCL_ID REM_ALT_PRCL_ID VISIBLE NONE;REM_PRCL_STATUS_DATE REM_PRCL_STATUS_DATE VISIBLE NONE;REM_MBLU_MAP REM_MBLU_MAP VISIBLE NONE;REM_MBLU_MAP_CUT REM_MBLU_MAP_CUT VISIBLE NONE;REM_MBLU_BLOCK REM_MBLU_BLOCK VISIBLE NONE;REM_MBLU_BLOCK_CUT REM_MBLU_BLOCK_CUT VISIBLE NONE;REM_MBLU_LOT REM_MBLU_LOT VISIBLE NONE;REM_MBLU_LOT_CUT REM_MBLU_LOT_CUT VISIBLE NONE;REM_MBLU_UNIT REM_MBLU_UNIT VISIBLE NONE;REM_MBLU_UNIT_CUT REM_MBLU_UNIT_CUT VISIBLE NONE;REM_STATUS_DATE REM_STATUS_DATE VISIBLE NONE;REM_INET_SUPPRESS REM_INET_SUPPRESS VISIBLE NONE;REM_IS_CONDO_MAIN REM_IS_CONDO_MAIN VISIBLE NONE;REM_CMPLX_NAME REM_CMPLX_NAME VISIBLE NONE;REM_BLDG_NAME REM_BLDG_NAME VISIBLE NONE;REM_USE_CODE REM_USE_CODE VISIBLE NONE;REM_LEGAL_AREA REM_LEGAL_AREA VISIBLE NONE;REM_LAST_UPDATE REM_LAST_UPDATE VISIBLE NONE;REM_USRFLD REM_USRFLD VISIBLE NONE;REM_USRFLD_DESC REM_USRFLD_DESC VISIBLE NONE;PID_TEXT PID_TEXT VISIBLE NONE;LND_USE_CODE LND_USE_CODE VISIBLE NONE;LND_USE_DESC LND_USE_DESC VISIBLE NONE;LND_DSTRCT LND_DSTRCT VISIBLE NONE;PRC_PF_LOCN PRC_PF_LOCN VISIBLE NONE;PRC_PF_LOCN_DESC PRC_PF_LOCN_DESC VISIBLE NONE;PRC_USRFLD_09 PRC_USRFLD_09 VISIBLE NONE;PRC_USRFLD_10 PRC_USRFLD_10 VISIBLE NONE;PRC_TTL_ASSESS_BLDG PRC_TTL_ASSESS_BLDG VISIBLE NONE;PRC_TTL_ASSESS_IMPROVEMENTS PRC_TTL_ASSESS_IMPROVEMENTS VISIBLE NONE;PRC_TTL_ASSESS_LND PRC_TTL_ASSESS_LND VISIBLE NONE;PRC_TTL_ASSESS_OB PRC_TTL_ASSESS_OB VISIBLE NONE;PRC_VALUE PRC_VALUE VISIBLE NONE;PRC_CMPLX_PID PRC_CMPLX_PID VISIBLE NONE;PRC_CMPLX_DESC PRC_CMPLX_DESC VISIBLE NONE;PRC_CENSUS PRC_CENSUS VISIBLE NONE;PRC_TTL_MRKT_ASSESS PRC_TTL_MRKT_ASSESS VISIBLE NONE;PRC_TTL_ASSESS PRC_TTL_ASSESS VISIBLE NONE;OWN_ID OWN_ID VISIBLE NONE;OWN_NAME1 OWN_NAME1 VISIBLE NONE;OWN_NAME2 OWN_NAME2 VISIBLE NONE;ROW_PID ROW_PID VISIBLE NONE;ROW_OWN_PCT ROW_OWN_PCT VISIBLE NONE;MAD_MAIL_NAME1 MAD_MAIL_NAME1 VISIBLE NONE;MAD_MAIL_NAME2 MAD_MAIL_NAME2 VISIBLE NONE;MAD_MAIL_ADDR1 MAD_MAIL_ADDR1 VISIBLE NONE;MAD_MAIL_CITY MAD_MAIL_CITY VISIBLE NONE;MAD_MAIL_STATE MAD_MAIL_STATE VISIBLE NONE;MAD_MAIL_ZIP MAD_MAIL_ZIP VISIBLE NONE;MAD_MAIL_ADDR2 MAD_MAIL_ADDR2 VISIBLE NONE;SLH_PID SLH_PID VISIBLE NONE;SLH_SALE_DATE SLH_SALE_DATE VISIBLE NONE;SLH_BOOK SLH_BOOK VISIBLE NONE;SLH_PAGE SLH_PAGE VISIBLE NONE;SLH_PRICE SLH_PRICE VISIBLE NONE;SLH_CURRENT_OWNER SLH_CURRENT_OWNER VISIBLE NONE;GIS_ACRES GIS_ACRES VISIBLE NONE;LANDEX_URL LANDEX_URL VISIBLE NONE;SHAPE SHAPE VISIBLE NONE;GlobalID GlobalID VISIBLE NONE;LONGITUDE_X LONGITUDE_X VISIBLE NONE;LATITUDE_Y LATITUDE_Y VISIBLE NONE;OBJECTID OBJECTID VISIBLE NONE;SHAPE.STArea() SHAPE.STArea() VISIBLE NONE;SHAPE.STLength() SHAPE.STLength() VISIBLE NONE")
except:
    print ("\n Unable to make feature layer from Tax parcel - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
    write_log("Unable to make feature layer from Tax parcel - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", logfile)
    logging.exception('Got exception on make feature layer from Tax parcel - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 logged at:' + str(Day) + " " + str(Time))
    raise
    sys.exit ()

try:
    # Process: append Tax parcels - PUBLIC_WEB from filtered layer of Tax parcels - AUTOWORKSPACE\ASSESSMENT (append temporary layer created above into web facing FC)
    arcpy.Append_management(Tax_Parcel_Not_INET_SUPRESSED, TAX_PARCELS_WEB, "NO_TEST", 'CAMA_PIN "MBLU (Map Block Lot Unit)" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,CAMA_PIN,-1,-1;MAP "Map" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAP,-1,-1;PARCEL "Parcel" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PARCEL,-1,-1;LOT "Lot" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,LOT,-1,-1;SEC_MUNI_NAME "Municipal Name" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SEC_MUNI_NAME,-1,-1;PID "PID Number" true true false 4 Long 0 10 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PID,-1,-1;REM_PID "PID Number" true true false 4 Long 0 10 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PID,-1,-1;REM_PIN "UPI Number" true true false 35 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PIN,-1,-1;REM_OWN_NAME "Owner Name" true true false 85 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_OWN_NAME,-1,-1;REM_PRCL_LOCN "Parcel Location" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PRCL_LOCN,-1,-1;REM_PRCL_LOCN_CITY "Parcel Location City" true true false 18 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PRCL_LOCN_CITY,-1,-1;REM_PRCL_LOCN_STT "Parcel Location State" true true false 2 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PRCL_LOCN_STT,-1,-1;REM_PRCL_LOCN_ZIP "Parcel Location Zipcode" true true false 12 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PRCL_LOCN_ZIP,-1,-1;REM_ALT_PRCL_ID "Old IBM Number" true true false 35 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_ALT_PRCL_ID,-1,-1;REM_PRCL_STATUS_DATE "Parcel Status date - CAMA Software" true true false 8 Date 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_PRCL_STATUS_DATE,-1,-1;REM_MBLU_MAP "Map" true true false 7 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_MAP,-1,-1;REM_MBLU_MAP_CUT "Map Cut - Not Used" true true false 3 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_MAP_CUT,-1,-1;REM_MBLU_BLOCK "Block" true true false 7 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_BLOCK,-1,-1;REM_MBLU_BLOCK_CUT "Block Cut - Not Used" true true false 3 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_BLOCK_CUT,-1,-1;REM_MBLU_LOT "Lot" true true false 7 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_LOT,-1,-1;REM_MBLU_LOT_CUT "Lot Cut - Not Used" true true false 3 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_LOT_CUT,-1,-1;REM_MBLU_UNIT "Unit" true true false 7 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_UNIT,-1,-1;REM_MBLU_UNIT_CUT "Unit Cut - Not Used" true true false 3 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_MBLU_UNIT_CUT,-1,-1;REM_STATUS_DATE "Status Date - CAMA software" true true false 8 Date 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_STATUS_DATE,-1,-1;REM_IS_CONDO_MAIN "Is Condo Main Parcel" true true false 2 Short 0 5 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_IS_CONDO_MAIN,-1,-1;REM_CMPLX_NAME "Complex Name" true true false 30 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_CMPLX_NAME,-1,-1;REM_BLDG_NAME "Acreage and Description" true true false 60 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_BLDG_NAME,-1,-1;REM_USE_CODE "Use Code" true true false 4 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_USE_CODE,-1,-1;REM_LEGAL_AREA "Legal Area" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_LEGAL_AREA,-1,-1;REM_LAST_UPDATE "Last Update - CAMA software" true true false 8 Date 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_LAST_UPDATE,-1,-1;REM_USRFLD "6 digit PID" true true false 6 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_USRFLD,-1,-1;REM_USRFLD_DESC "Control Number" true true false 40 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,REM_USRFLD_DESC,-1,-1;PID_TEXT "PID Text format" true true false 15 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PID_TEXT,-1,-1;LND_USE_CODE "Land Use Code" true true false 4 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,LND_USE_CODE,-1,-1;LND_USE_DESC "Land Use Description" true true false 40 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,LND_USE_DESC,-1,-1;LND_DSTRCT "District Number" true true false 6 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,LND_DSTRCT,-1,-1;PRC_PF_LOCN "School District Code" true true false 15 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_PF_LOCN,-1,-1;PRC_PF_LOCN_DESC "School District" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_PF_LOCN_DESC,-1,-1;PRC_USRFLD_09 "User Field 9 - Not Used" true true false 30 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_USRFLD_09,-1,-1;PRC_USRFLD_10 "User Field 10 - Not Used" true true false 30 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_USRFLD_10,-1,-1;PRC_TTL_ASSESS_BLDG "Total Building Assessment" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_TTL_ASSESS_BLDG,-1,-1;PRC_TTL_ASSESS_IMPROVEMENTS "Total Improvements Assessment" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_TTL_ASSESS_IMPROVEMENTS,-1,-1;PRC_TTL_ASSESS_LND "Total Land Assessment" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_TTL_ASSESS_LND,-1,-1;PRC_TTL_ASSESS_OB "Total Out Building Assessment" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_TTL_ASSESS_OB,-1,-1;PRC_VALUE "Parcel Value" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_VALUE,-1,-1;PRC_CMPLX_PID "Complex PID" true true false 4 Long 0 10 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_CMPLX_PID,-1,-1;PRC_CMPLX_DESC "Complex Description" true true false 30 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_CMPLX_DESC,-1,-1;PRC_CENSUS "Census - Not Used" true true false 20 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_CENSUS,-1,-1;PRC_TTL_MRKT_ASSESS "Total Market Assessment" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_TTL_MRKT_ASSESS,-1,-1;PRC_TTL_ASSESS "Total Assessment" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,PRC_TTL_ASSESS,-1,-1;OWN_NAME1 "OWN_NAME1" true true false 85 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,OWN_NAME1,-1,-1;OWN_NAME2 "OWN_NAME2" true true false 85 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,OWN_NAME2,-1,-1;ROW_PID "ROW_PID" true true false 4 Long 0 10 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,ROW_PID,-1,-1;ROW_OWN_PCT "ROW_OWN_PCT" true true false 2 Short 0 5 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,ROW_OWN_PCT,-1,-1;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_NAME1,-1,-1;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_NAME2,-1,-1;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_ADDR1,-1,-1;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_CITY,-1,-1;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_STATE,-1,-1;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_ZIP,-1,-1;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,MAD_MAIL_ADDR2,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SLH_PID,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SLH_BOOK,-1,-1;SLH_PAGE "Deed Page" true true false 15 Text 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SLH_PAGE,-1,-1;SLH_PRICE "Sale Price" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SLH_PRICE,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,GlobalID,-1,-1;LONGITUDE_X "Longitude_X" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,LONGITUDE_X,-1,-1;LATITUDE_Y "Latitude_Y" true true false 8 Double 8 38 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,LATITUDE_Y,-1,-1;SHAPE.STArea() "SHAPE.STArea()" false false true 0 Double 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SHAPE.STArea(),-1,-1;SHAPE.STLength() "SHAPE.STLength()" false false true 0 Double 0 0 ,First,#,Tax_Parcel_Not_INET_SUPRESSED,SHAPE.STLength(),-1,-1', "")
    TaxParcel_Web_result = arcpy.GetCount_management(TAX_PARCELS_WEB)
    print (('{} has {} records'.format(TAX_PARCELS_WEB,  TaxParcel_Web_result[0])))
    write_log('{} has {} records'.format(TAX_PARCELS_WEB,  TaxParcel_Web_result[0]), logfile)
except:
    print ("\n Unable to append Tax parcels - PUBLIC_WEB from filtered layer of Tax parcels - AUTOWORKSPACE\ASSESSMENT")
    write_log("Unable to append Tax parcels - PUBLIC_WEB from filtered layer of Tax parcels - AUTOWORKSPACE\ASSESSMENT", logfile)
    logging.exception('Got exception on append Tax parcels - PUBLIC_WEB from filtered layer of Tax parcels - AUTOWORKSPACE\ASSESSMENT logged at:' + str(Day) + " " + str(Time))
    raise
    sys.exit ()

print ("       Updating Tax parcels - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Tax parcels - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating VISION_OWNER_TBL_WEB from CRAW_INTERNAL  - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
write_log("\n Updating VISION_OWNER_TBL_WEB from CRAW_INTERNAL  - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", logfile)

try:
    # Delete rows from VISION_OWNER_TBL_WEB
    arcpy.DeleteRows_management(VISION_OWNER_TBL_WEB)
except:
    print ("\n Unable to delete rows from VISION_OWNER_TBL_WEB")
    write_log("Unable to delete rows from VISION_OWNER_TBL_WEB", logfile)
    logging.exception('Got exception on delete rows from VISION_OWNER_TBL_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append rows from VISION_OWNER_TBL_INTERNAL from VISION_OWNER_TBL_WEBTemp - AUTOWORKSPACE (append from pre-filtered INET_SUPRESS field -  table was created in parcel builder program)
    arcpy.Append_management(VISION_OWNER_TBL_WEBTemp, VISION_OWNER_TBL_WEB, "NO_TEST", 'OWN_NAME1 "Owner Name 1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,OWN_NAME1,-1,-1;OWN_NAME2 "Owner Name 2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,OWN_NAME2,-1,-1;ROW_PID "PID Number" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,ROW_PID,-1,-1;ROW_OWN_PCT "Percentage of Ownership" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,ROW_OWN_PCT,-1,-1;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_NAME1,-1,-1;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_NAME2,-1,-1;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_ADDR1,-1,-1;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_CITY,-1,-1;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_STATE,-1,-1;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_ZIP,-1,-1;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MAD_MAIL_ADDR2,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,SLH_PID,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,SLH_BOOK,-1,-1;SLH_PAGE "Deed Page" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,SLH_PAGE,-1,-1;SLH_PRICE "Sale Price" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,SLH_PRICE,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0 ,First,#;MUNI_NAME "Municipality Name" true true false 75 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.VISION_OWNER_TBL_WEBTemp,MUNI_NAME,-1,-1', "")
    OwnerTbl_Public_result = arcpy.GetCount_management(VISION_OWNER_TBL_WEB)
    print (('{} has {} records'.format(VISION_OWNER_TBL_WEB,  OwnerTbl_Public_result[0])))
    write_log('{} has {} records'.format(VISION_OWNER_TBL_WEB,  OwnerTbl_Public_result[0]), logfile)  
except:
    print ("\n Unable to append rows from VISION_OWNER_TBL_INTERNAL from VISION_OWNER_TBL_WEBTemp - AUTOWORKSPACE (pre-filtered INET_SUPRESS field)")
    write_log("Unable to append rows from VISION_OWNER_TBL_INTERNAL from VISION_OWNER_TBL_WEBTemp - AUTOWORKSPACE (pre-filtered INET_SUPRESS field)", logfile)
    logging.exception('Got exception on append rows from VISION_OWNER_TBL_INTERNAL from VISION_OWNER_TBL_WEBTemp - AUTOWORKSPACE (pre-filtered INET_SUPRESS field) logged at:' + str(Day) + " " + str(Time))
    raise
    sys.exit ()

print ("       Updating VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating VISION_OWNER_TBL_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)    

print ("\n Updating Softlines - CRAW_INTERNAL from AST")
write_log("\n Updating Softlines - CRAW_INTERNAL from AST", logfile)

try:
    # Delete rows from Softlines - CRAW_INTERNAL
    arcpy.DeleteRows_management(SOFTLINES_INTERNAL)
except:
    print ("\n Unable to delete rows from Softlines - CRAW_INTERNAL")
    write_log("Unable to delete rows from Softlines - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Softlines - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()
    
try:
    # Append Softlines - CRAW_INTERNAL from AST
    arcpy.Append_management(SOFTLINES_AST, SOFTLINES_INTERNAL,"NO_TEST", 'TYPE "TYPE" true true false 2 Short 0 5 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.Softlines,TYPE,-1,-1;GLOBALID "GLOBALID" false false false 38 GlobalID 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.Softlines,GLOBALID,-1,-1;EDITOR "EDITOR" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.Softlines,EDITOR,-1,-1;DATEMODIFY "DATEMODIFY" true true false 8 Date 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.Softlines,DATEMODIFY,-1,-1;SHAPE.STLength() "SHAPE.STLength()" false false true 0 Double 0 0 ,First,#', "")
    Softlines_Internal_result = arcpy.GetCount_management(SOFTLINES_INTERNAL)
    print (('{} has {} records'.format(SOFTLINES_INTERNAL,  Softlines_Internal_result[0])))
    write_log('{} has {} records'.format(SOFTLINES_INTERNAL,  Softlines_Internal_result[0]), logfile)
except:
    print ("\n Unable to append Softlines - CRAW_INTERNAL from AST")
    write_log("Unable to append Softlines - CRAW_INTERNAL from AST", logfile)
    logging.exception('Got exception on append Softlines - CRAW_INTERNAL from AST logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Softlines - CRAW_INTERNAL from AST completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Softlines - CRAW_INTERNAL from AST completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Softlines - PUBLIC_WEB from CRAW_INTERNAL")
write_log("\n Updating Softlines - PUBLIC_WEB from CRAW_INTERNAL", logfile)

try:
    # Delete rows from Softlines - PUBLIC_WEB
    arcpy.DeleteRows_management(SOFTLINES_WEB)
except:
    print ("\n Unable to delete rows from Softlines - PUBLIC_WEB")
    write_log("Unable to delete rows from Softlines - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from Softlines - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append Softlines - PUBLIC_WEB from CRAW_INTERNAL
    arcpy.Append_management(SOFTLINES_INTERNAL, SOFTLINES_WEB, "NO_TEST", "TYPE \"TYPE\" true true false 2 Short 0 5 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.SOFTLINES_INTERNAL,TYPE,-1,-1;GLOBALID \"GLOBALID\" false false false 38 GlobalID 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.SOFTLINES_INTERNAL,GLOBALID,-1,-1;EDITOR \"EDITOR\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.SOFTLINES_INTERNAL,EDITOR,-1,-1;DATEMODIFY \"DATEMODIFY\" true true false 8 Date 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.SOFTLINES_INTERNAL,DATEMODIFY,-1,-1;SHAPE.STLength() \"SHAPE.STLength()\" false false true 0 Double 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.SOFTLINES_INTERNAL,SHAPE.STLength(),-1,-1", "")
    Softlines_Web_result = arcpy.GetCount_management(SOFTLINES_WEB)
    print (('{} has {} records'.format(SOFTLINES_WEB,  Softlines_Web_result[0])))
    write_log('{} has {} records'.format(SOFTLINES_WEB,  Softlines_Web_result[0]), logfile)
except:
    print ("\n Unable to append Softlines - PUBLIC_WEB from CRAW_INTERNAL")
    write_log("Unable to append Softlines - PUBLIC_WEB from CRAW_INTERNAL", logfile)
    logging.exception('Got exception on update Softlines - PUBLIC_WEB from CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Softlines - PUBLIC_WEB from CRAW_INTERNAL completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Softlines - PUBLIC_WEB from CRAW_INTERNAL completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating ID Points - CRAW_INTERNAL from AST")
write_log("\n Updating ID Points - CRAW_INTERNAL from AST", logfile)

try:
    # Delete rows from ID Points - CRAW_INTERNAL
    arcpy.DeleteRows_management(ID_POINT_INTERNAL)
except:
    print ("\n Unable to delete rows from ID Points - CRAW_INTERNAL")
    write_log("Unable to delete rows from ID Points - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from ID Points - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append ID Points - CRAW_INTERNAL from AST
    arcpy.Append_management(ID_POINT_AST, ID_POINT_INTERNAL, "NO_TEST", 'SUBDIV_NAME "SUBDIV_NAME" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,SUBDIV_NAME,-1,-1;TRACT_NUM "TRACT_NUM" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,TRACT_NUM,-1,-1;TYPE "TYPE" true true false 2 Short 0 5 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,TYPE,-1,-1;LOT "LOT" true true false 12 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,LOT,-1,-1;GLOBALID "GLOBALID" false false false 38 GlobalID 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,GLOBALID,-1,-1;BLOCK "BLOCK" true true false 5 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,BLOCK,-1,-1;MAPTYPE "MAPTYPE" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,MAPTYPE,-1,-1;MAP "MAP" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,MAP,-1,-1;INSERTMAP "INSERTMAP" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,INSERTMAP,-1,-1;EDITOR "EDITOR" true true false 50 Text 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,EDITOR,-1,-1;DATE_MODIFY "DATE_MODIFY" true true false 8 Date 0 0 ,First,#,Database Connections\AST@ccsde.sde\AST.Crawford_Parcels\AST.ID_Point,DATE_MODIFY,-1,-1', "")
    IDPoints_Internal_result = arcpy.GetCount_management(ID_POINT_INTERNAL)
    print (('{} has {} records'.format(ID_POINT_INTERNAL,  IDPoints_Internal_result[0])))
    write_log('{} has {} records'.format(ID_POINT_INTERNAL,  IDPoints_Internal_result[0]), logfile)
except:
    print ("\n Unable to append ID Points - CRAW_INTERNAL from AST")
    write_log("Unable to append ID Points - CRAW_INTERNAL from AST", logfile)
    logging.exception('Got exception on append ID Points - CRAW_INTERNAL from AST logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating ID Points - CRAW_INTERNAL from AST completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating ID Points - CRAW_INTERNAL from AST completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating ID Points - PUBLIC_WEB from CRAW_INTERNAL")
write_log("\n Updating ID Points - PUBLIC_WEB from CRAW_INTERNAL", logfile)

try:
    # Delete rows from ID Points - PUBLIC_WEB
    arcpy.DeleteRows_management(ID_POINT_WEB)
except:
    print ("\n Unable to delete rows from ID Points - PUBLIC_WEB")
    write_log("Unable to delete rows from ID Points - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from ID Points - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append ID Points - PUBLIC_WEB from CRAW_INTERNAL
    arcpy.Append_management(ID_POINT_INTERNAL, ID_POINT_WEB, "NO_TEST", "SUBDIV_NAME \"SUBDIV_NAME\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,SUBDIV_NAME,-1,-1;TRACT_NUM \"TRACT_NUM\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,TRACT_NUM,-1,-1;TYPE \"TYPE\" true true false 2 Short 0 5 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,TYPE,-1,-1;LOT \"LOT\" true true false 12 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,LOT,-1,-1;GLOBALID \"GLOBALID\" false false false 38 GlobalID 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,GLOBALID,-1,-1;BLOCK \"BLOCK\" true true false 5 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,BLOCK,-1,-1;MAPTYPE \"MAPTYPE\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,MAPTYPE,-1,-1;MAP \"MAP\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,MAP,-1,-1;INSERTMAP \"INSERTMAP\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,INSERTMAP,-1,-1;EDITOR \"EDITOR\" true true false 50 Text 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,EDITOR,-1,-1;DATE_MODIFY \"DATE_MODIFY\" true true false 8 Date 0 0 ,First,#,Database Connections\\craw_internal@ccsde.sde\\CCSDE.CRAW_INTERNAL.Land_Records\\CCSDE.CRAW_INTERNAL.ID_POINT_INTERNAL,DATE_MODIFY,-1,-1", "")
    IDPoints_Web_result = arcpy.GetCount_management(ID_POINT_WEB)
    print (('{} has {} records'.format(ID_POINT_WEB,  IDPoints_Web_result[0])))
    write_log('{} has {} records'.format(ID_POINT_WEB,  IDPoints_Web_result[0]), logfile)
except:
    print ("\n Unable to append ID Points - PUBLIC_WEB from CRAW_INTERNAL")
    write_log("Unable to append ID Points - PUBLIC_WEB from CRAW_INTERNAL", logfile)
    logging.exception('Got exception on append ID Points - PUBLIC_WEB from CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating ID Points - PUBLIC_WEB from CRAW_INTERNAL completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating ID Points - PUBLIC_WEB from CRAW_INTERNAL completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

##print ("\n Updating Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
##write_log("\n Updating Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)
##
##try:
##    # Delete rows from Building/Trailer Only - CRAW_INTERNAL
##    arcpy.DeleteRows_management(BUILDING_ONLY_INTERNAL)
##except:
##    print ("\n Unable to delete rows from Building/Trailer Only - CRAW_INTERNAL")
##    write_log("Unable to delete rows from Building/Trailer Only - CRAW_INTERNAL", logfile)
##    logging.exception('Got exception on delete rows from Building/Trailer Only - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
##    raise
##    sys.exit ()
##
##try:
##    # Append Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT
##    arcpy.Append_management(BUILDING_ONLY_AUTOWKSP, BUILDING_ONLY_INTERNAL, "NO_TEST", 'REM_PID "PID" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PID,-1,-1;CAMA_PIN "MBLU (Map Block Lot Unit)" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,CAMA_PIN,-1,-1;REM_PIN "UPI Number" true true false 35 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PIN,-1,-1;REM_OWN_NAME "Owner Name" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_OWN_NAME,-1,-1;REM_PRCL_LOCN "Parcel Location" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PRCL_LOCN,-1,-1;REM_PRCL_LOCN_CITY "Parcel Location City" true true false 18 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PRCL_LOCN_CITY,-1,-1;REM_PRCL_LOCN_STT "Parcel Location State" true true false 2 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PRCL_LOCN_STT,-1,-1;REM_PRCL_LOCN_ZIP "Parcel Location Zipcode" true true false 12 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PRCL_LOCN_ZIP,-1,-1;REM_ALT_PRCL_ID "Old IBM Number" true true false 35 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_ALT_PRCL_ID,-1,-1;REM_PRCL_STATUS_DATE "Parcel Status date - CAMA Software" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_PRCL_STATUS_DATE,-1,-1;REM_MBLU_MAP "Map" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_MAP,-1,-1;REM_MBLU_MAP_CUT "Map Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_MAP_CUT,-1,-1;REM_MBLU_BLOCK "Block" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_BLOCK,-1,-1;REM_MBLU_BLOCK_CUT "Block Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_BLOCK_CUT,-1,-1;REM_MBLU_LOT "Lot" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_LOT,-1,-1;REM_MBLU_LOT_CUT "Lot Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_LOT_CUT,-1,-1;REM_MBLU_UNIT "Unit" true true false 7 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_UNIT,-1,-1;REM_MBLU_UNIT_CUT "Unit Cut - Not Used" true true false 3 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_MBLU_UNIT_CUT,-1,-1;REM_STATUS_DATE "Status Date - CAMA software" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_STATUS_DATE,-1,-1;REM_INET_SUPPRESS "Internet Suppression" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_INET_SUPPRESS,-1,-1;REM_IS_CONDO_MAIN "Is Condo Main Parcel" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_IS_CONDO_MAIN,-1,-1;REM_CMPLX_NAME "Complex Name" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_CMPLX_NAME,-1,-1;REM_BLDG_NAME "Acreage and Description" true true false 60 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_BLDG_NAME,-1,-1;REM_USE_CODE "Use Code" true true false 4 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_USE_CODE,-1,-1;REM_LEGAL_AREA "Legal Area" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_LEGAL_AREA,-1,-1;REM_LAST_UPDATE "Last Update - CAMA software" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_LAST_UPDATE,-1,-1;REM_USRFLD "6 digit PID" true true false 6 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_USRFLD,-1,-1;REM_USRFLD_DESC "Control Number" true true false 40 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,REM_USRFLD_DESC,-1,-1;PID_TEXT "PID Text format" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PID_TEXT,-1,-1;LND_USE_CODE "Land Use Code" true true false 4 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,LND_USE_CODE,-1,-1;LND_USE_DESC "Land Use Description" true true false 40 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,LND_USE_DESC,-1,-1;LND_DSTRCT "District Number" true true false 6 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,LND_DSTRCT,-1,-1;PRC_PF_LOCN "School District Code" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_PF_LOCN,-1,-1;PRC_PF_LOCN_DESC "School District" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_PF_LOCN_DESC,-1,-1;PRC_USRFLD_09 "User Field 9 - Not Used" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_USRFLD_09,-1,-1;PRC_USRFLD_10 "User Field 10 - Not Used" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_USRFLD_10,-1,-1;PRC_TTL_ASSESS_BLDG "Total Building Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_TTL_ASSESS_BLDG,-1,-1;PRC_TTL_ASSESS_IMPROVEMENTS "Total Improvements Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_TTL_ASSESS_IMPROVEMENTS,-1,-1;PRC_TTL_ASSESS_LND "Total Land Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_TTL_ASSESS_LND,-1,-1;PRC_TTL_ASSESS_OB "Total Out Building Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_TTL_ASSESS_OB,-1,-1;PRC_VALUE "Parcel Value" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_VALUE,-1,-1;PRC_CMPLX_PID "Complex PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_CMPLX_PID,-1,-1;PRC_CMPLX_DESC "Complex Description" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_CMPLX_DESC,-1,-1;PRC_CENSUS "Census - Not Used" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_CENSUS,-1,-1;PRC_TTL_MRKT_ASSESS "Total Market Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_TTL_MRKT_ASSESS,-1,-1;PRC_TTL_ASSESS "Total Assessment" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,PRC_TTL_ASSESS,-1,-1;OWN_NAME1 "OWN_NAME1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,OWN_NAME1,-1,-1;OWN_NAME2 "OWN_NAME2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,OWN_NAME2,-1,-1;ROW_PID "ROW_PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,ROW_PID,-1,-1;ROW_OWN_PCT "ROW_OWN_PCT" true true false 2 Short 0 5 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,ROW_OWN_PCT,-1,-1;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_NAME1,-1,-1;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_NAME2,-1,-1;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_ADDR1,-1,-1;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_CITY,-1,-1;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_STATE,-1,-1;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_ZIP,-1,-1;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MAD_MAIL_ADDR2,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,SLH_PID,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,SLH_BOOK,-1,-1;SLH_PAGE "Deed Page" true true false 15 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,SLH_PAGE,-1,-1;SLH_PRICE "Sale Price" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,SLH_PRICE,-1,-1;GlobalID "GlobalID" false false true 38 GlobalID 0 0 ,First,#;LONGITUDE_X "Longitude_X" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,LONGITUDE_X,-1,-1;LATITUDE_Y "Latitude_Y" true true false 8 Double 8 38 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,LATITUDE_Y,-1,-1;MUNI_NAME "Municipality Name" true true false 75 Text 0 0 ,First,#,Database Connections\\auto_workspace@ccsde.sde\\CCSDE.AUTO_WORKSPACE.Assessment\\CCSDE.AUTO_WORKSPACE.Building_Only_Joined,MUNI_NAME,-1,-1', "")
##    BuildingOnly_Internal_result = arcpy.GetCount_management(BUILDING_ONLY_INTERNAL)
##    print (('{} has {} records'.format(BUILDING_ONLY_INTERNAL,  BuildingOnly_Internal_result[0])))
##    write_log('{} has {} records'.format(BUILDING_ONLY_INTERNAL,  BuildingOnly_Internal_result[0]), logfile)
##except:
##    print ("\n Unable to append Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
##    write_log("Unable to append Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)
##    logging.exception('Got exception on append Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
##    raise
##    sys.exit ()
##
##print ("       Updating Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
##write_log("       Updating Building/Trailer Only - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)
##
##print ("\n Updating Building/Trailer Only - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
##write_log("\n Updating Building/Trailer Only - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", logfile)
##
##try:
##    # Delete rows from Building/Trailer Only - PUBLIC_WEB
##    arcpy.DeleteRows_management(BUILDING_ONLY_WEB)
##except:
##    print ("\n Unable to delete rows from Building/Trailer Only - PUBLIC_WEB")
##    write_log("Unable to delete rows from Building/Trailer Only - PUBLIC_WEB", logfile)
##    logging.exception('Got exception on delete rows from Building/Trailer Only - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
##    raise
##    sys.exit ()
##
##try:
##    # Make feature layer from Building/Trailer Only - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 (make temporary layer in memory, filtering out REM_INET_SUPPRESS not = to 1, as they are allowed to be legally redacted from the public web)
##    BUILDING_ONLY_INTERNAL_Layer = arcpy.MakeFeatureLayer_management(BUILDING_ONLY_INTERNAL, "BUILDING_ONLY_INTERNAL_Layer", "REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", "", "REM_PID REM_PID VISIBLE NONE;CAMA_PIN CAMA_PIN VISIBLE NONE;REM_PIN REM_PIN VISIBLE NONE;REM_OWN_NAME REM_OWN_NAME VISIBLE NONE;REM_PRCL_LOCN REM_PRCL_LOCN VISIBLE NONE;REM_PRCL_LOCN_CITY REM_PRCL_LOCN_CITY VISIBLE NONE;REM_PRCL_LOCN_STT REM_PRCL_LOCN_STT VISIBLE NONE;REM_PRCL_LOCN_ZIP REM_PRCL_LOCN_ZIP VISIBLE NONE;REM_ALT_PRCL_ID REM_ALT_PRCL_ID VISIBLE NONE;REM_PRCL_STATUS_DATE REM_PRCL_STATUS_DATE VISIBLE NONE;REM_MBLU_MAP REM_MBLU_MAP VISIBLE NONE;REM_MBLU_MAP_CUT REM_MBLU_MAP_CUT VISIBLE NONE;REM_MBLU_BLOCK REM_MBLU_BLOCK VISIBLE NONE;REM_MBLU_BLOCK_CUT REM_MBLU_BLOCK_CUT VISIBLE NONE;REM_MBLU_LOT REM_MBLU_LOT VISIBLE NONE;REM_MBLU_LOT_CUT REM_MBLU_LOT_CUT VISIBLE NONE;REM_MBLU_UNIT REM_MBLU_UNIT VISIBLE NONE;REM_MBLU_UNIT_CUT REM_MBLU_UNIT_CUT VISIBLE NONE;REM_STATUS_DATE REM_STATUS_DATE VISIBLE NONE;REM_INET_SUPPRESS REM_INET_SUPPRESS VISIBLE NONE;REM_IS_CONDO_MAIN REM_IS_CONDO_MAIN VISIBLE NONE;REM_CMPLX_NAME REM_CMPLX_NAME VISIBLE NONE;REM_BLDG_NAME REM_BLDG_NAME VISIBLE NONE;REM_USE_CODE REM_USE_CODE VISIBLE NONE;REM_LEGAL_AREA REM_LEGAL_AREA VISIBLE NONE;REM_LAST_UPDATE REM_LAST_UPDATE VISIBLE NONE;REM_USRFLD REM_USRFLD VISIBLE NONE;REM_USRFLD_DESC REM_USRFLD_DESC VISIBLE NONE;PID_TEXT PID_TEXT VISIBLE NONE;LND_USE_CODE LND_USE_CODE VISIBLE NONE;LND_USE_DESC LND_USE_DESC VISIBLE NONE;LND_DSTRCT LND_DSTRCT VISIBLE NONE;PRC_PF_LOCN PRC_PF_LOCN VISIBLE NONE;PRC_PF_LOCN_DESC PRC_PF_LOCN_DESC VISIBLE NONE;PRC_USRFLD_09 PRC_USRFLD_09 VISIBLE NONE;PRC_USRFLD_10 PRC_USRFLD_10 VISIBLE NONE;PRC_TTL_ASSESS_BLDG PRC_TTL_ASSESS_BLDG VISIBLE NONE;PRC_TTL_ASSESS_IMPROVEMENTS PRC_TTL_ASSESS_IMPROVEMENTS VISIBLE NONE;PRC_TTL_ASSESS_LND PRC_TTL_ASSESS_LND VISIBLE NONE;PRC_TTL_ASSESS_OB PRC_TTL_ASSESS_OB VISIBLE NONE;PRC_VALUE PRC_VALUE VISIBLE NONE;PRC_CMPLX_PID PRC_CMPLX_PID VISIBLE NONE;PRC_CMPLX_DESC PRC_CMPLX_DESC VISIBLE NONE;PRC_CENSUS PRC_CENSUS VISIBLE NONE;PRC_TTL_MRKT_ASSESS PRC_TTL_MRKT_ASSESS VISIBLE NONE;PRC_TTL_ASSESS PRC_TTL_ASSESS VISIBLE NONE;OWN_NAME1 OWN_NAME1 VISIBLE NONE;OWN_NAME2 OWN_NAME2 VISIBLE NONE;ROW_PID ROW_PID VISIBLE NONE;ROW_OWN_PCT ROW_OWN_PCT VISIBLE NONE;MAD_MAIL_NAME1 MAD_MAIL_NAME1 VISIBLE NONE;MAD_MAIL_NAME2 MAD_MAIL_NAME2 VISIBLE NONE;MAD_MAIL_ADDR1 MAD_MAIL_ADDR1 VISIBLE NONE;MAD_MAIL_CITY MAD_MAIL_CITY VISIBLE NONE;MAD_MAIL_STATE MAD_MAIL_STATE VISIBLE NONE;MAD_MAIL_ZIP MAD_MAIL_ZIP VISIBLE NONE;MAD_MAIL_ADDR2 MAD_MAIL_ADDR2 VISIBLE NONE;SLH_PID SLH_PID VISIBLE NONE;SLH_SALE_DATE SLH_SALE_DATE VISIBLE NONE;SLH_BOOK SLH_BOOK VISIBLE NONE;SLH_PAGE SLH_PAGE VISIBLE NONE;SLH_PRICE SLH_PRICE VISIBLE NONE;Shape Shape VISIBLE NONE;GlobalID GlobalID VISIBLE NONE;LONGITUDE_X LONGITUDE_X VISIBLE NONE;LATITUDE_Y LATITUDE_Y VISIBLE NONE;OBJECTID OBJECTID VISIBLE NONE;MUNI_NAME MUNI_NAME VISIBLE NONE")
##except:
##    print ("\n Unable to make feature layer from Building/Trailer Only - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
##    write_log("Unable to make feature layer from Building/Trailer Only - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", logfile)
##    logging.exception('Got exception on make feature layer from Building/Trailer Only - CRAW_INTERNAL // filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
##    raise
##    sys.exit ()
##    
##try:
##    # Append Building/Trailer Only - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL (append temporary layer created above into web facing FC)
##    arcpy.Append_management(BUILDING_ONLY_INTERNAL_Layer, BUILDING_ONLY_WEB, "NO_TEST", 'REM_PID "PID Number" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PID,-1,-1;CAMA_PIN "MBLU (Map Block Lot Unit)" true true false 50 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,CAMA_PIN,-1,-1;REM_PIN "UPI Number" true true false 35 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PIN,-1,-1;REM_OWN_NAME "Owner Name" true true false 85 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_OWN_NAME,-1,-1;REM_PRCL_LOCN "Parcel Location" true true false 50 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PRCL_LOCN,-1,-1;REM_PRCL_LOCN_CITY "Parcel Location City" true true false 18 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PRCL_LOCN_CITY,-1,-1;REM_PRCL_LOCN_STT "Parcel Location State" true true false 2 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PRCL_LOCN_STT,-1,-1;REM_PRCL_LOCN_ZIP "Parcel Location Zipcode" true true false 12 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PRCL_LOCN_ZIP,-1,-1;REM_ALT_PRCL_ID "Old IBM Number" true true false 35 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_ALT_PRCL_ID,-1,-1;REM_PRCL_STATUS_DATE "Parcel Status date - CAMA Software" true true false 8 Date 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_PRCL_STATUS_DATE,-1,-1;REM_MBLU_MAP "Map" true true false 7 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_MAP,-1,-1;REM_MBLU_MAP_CUT "Map Cut - Not Used" true true false 3 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_MAP_CUT,-1,-1;REM_MBLU_BLOCK "Block" true true false 7 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_BLOCK,-1,-1;REM_MBLU_BLOCK_CUT "Block Cut - Not Used" true true false 3 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_BLOCK_CUT,-1,-1;REM_MBLU_LOT "Lot" true true false 7 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_LOT,-1,-1;REM_MBLU_LOT_CUT "Lot Cut - Not Used" true true false 3 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_LOT_CUT,-1,-1;REM_MBLU_UNIT "Unit" true true false 7 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_UNIT,-1,-1;REM_MBLU_UNIT_CUT "Unit Cut - Not Used" true true false 3 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_MBLU_UNIT_CUT,-1,-1;REM_STATUS_DATE "Status Date - CAMA software" true true false 8 Date 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_STATUS_DATE,-1,-1;REM_IS_CONDO_MAIN "Is Condo Main Parcel" true true false 2 Short 0 5 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_IS_CONDO_MAIN,-1,-1;REM_CMPLX_NAME "Complex Name" true true false 30 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_CMPLX_NAME,-1,-1;REM_BLDG_NAME "Acreage and Description" true true false 60 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_BLDG_NAME,-1,-1;REM_USE_CODE "Use Code" true true false 4 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_USE_CODE,-1,-1;REM_LEGAL_AREA "Legal Area" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_LEGAL_AREA,-1,-1;REM_LAST_UPDATE "Last Update - CAMA software" true true false 8 Date 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_LAST_UPDATE,-1,-1;REM_USRFLD "6 digit PID" true true false 6 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_USRFLD,-1,-1;REM_USRFLD_DESC "Control Number" true true false 40 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,REM_USRFLD_DESC,-1,-1;PID_TEXT "PID Text format" true true false 15 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PID_TEXT,-1,-1;LND_USE_CODE "Land Use Code" true true false 4 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,LND_USE_CODE,-1,-1;LND_USE_DESC "Land Use Description" true true false 40 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,LND_USE_DESC,-1,-1;LND_DSTRCT "District Number" true true false 6 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,LND_DSTRCT,-1,-1;PRC_PF_LOCN "School District Code" true true false 15 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_PF_LOCN,-1,-1;PRC_PF_LOCN_DESC "School District" true true false 50 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_PF_LOCN_DESC,-1,-1;PRC_USRFLD_09 "User Field 9 - Not Used" true true false 30 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_USRFLD_09,-1,-1;PRC_USRFLD_10 "User Field 10 - Not Used" true true false 30 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_USRFLD_10,-1,-1;PRC_TTL_ASSESS_BLDG "Total Building Assessment" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_TTL_ASSESS_BLDG,-1,-1;PRC_TTL_ASSESS_IMPROVEMENTS "Total Improvements Assessment" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_TTL_ASSESS_IMPROVEMENTS,-1,-1;PRC_TTL_ASSESS_LND "Total Land Assessment" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_TTL_ASSESS_LND,-1,-1;PRC_TTL_ASSESS_OB "Total Out Building Assessment" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_TTL_ASSESS_OB,-1,-1;PRC_VALUE "Parcel Value" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_VALUE,-1,-1;PRC_CMPLX_PID "Complex PID" true true false 4 Long 0 10 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_CMPLX_PID,-1,-1;PRC_CMPLX_DESC "Complex Description" true true false 30 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_CMPLX_DESC,-1,-1;PRC_CENSUS "Census - Not Used" true true false 20 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_CENSUS,-1,-1;PRC_TTL_MRKT_ASSESS "Total Market Assessment" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_TTL_MRKT_ASSESS,-1,-1;PRC_TTL_ASSESS "Total Assessment" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,PRC_TTL_ASSESS,-1,-1;OWN_NAME1 "OWN_NAME1" true true false 85 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,OWN_NAME1,-1,-1;OWN_NAME2 "OWN_NAME2" true true false 85 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,OWN_NAME2,-1,-1;ROW_PID "ROW_PID" true true false 4 Long 0 10 ,First,#,BUILDING_ONLY_INTERNAL_Layer,ROW_PID,-1,-1;ROW_OWN_PCT "ROW_OWN_PCT" true true false 2 Short 0 5 ,First,#,BUILDING_ONLY_INTERNAL_Layer,ROW_OWN_PCT,-1,-1;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_NAME1,-1,-1;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_NAME2,-1,-1;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_ADDR1,-1,-1;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_CITY,-1,-1;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_STATE,-1,-1;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_ZIP,-1,-1;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MAD_MAIL_ADDR2,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10 ,First,#,BUILDING_ONLY_INTERNAL_Layer,SLH_PID,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,SLH_BOOK,-1,-1;SLH_PAGE "Deed Page" true true false 15 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,SLH_PAGE,-1,-1;SLH_PRICE "Sale Price" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,SLH_PRICE,-1,-1;GlobalID "GlobalID" false false false 38 GlobalID 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,GlobalID,-1,-1;LONGITUDE_X "Longitude_X" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,LONGITUDE_X,-1,-1;LATITUDE_Y "Latitude_Y" true true false 8 Double 8 38 ,First,#,BUILDING_ONLY_INTERNAL_Layer,LATITUDE_Y,-1,-1;MUNI_NAME "Municipality Name" true true false 75 Text 0 0 ,First,#,BUILDING_ONLY_INTERNAL_Layer,MUNI_NAME,-1,-1', "")
##    BuildingOnly_Web_result = arcpy.GetCount_management(BUILDING_ONLY_WEB)
##    print (('{} has {} records'.format(BUILDING_ONLY_WEB,  BuildingOnly_Web_result[0])))
##    write_log('{} has {} records'.format(BUILDING_ONLY_WEB,  BuildingOnly_Web_result[0]), logfile)
##except:
##    print ("\n Unable to append Building/Trailer Only - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL")
##    write_log("Unable to append Building/Trailer Only - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL", logfile)
##    logging.exception('Got exception on append Building/Trailer Only - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
##    raise
##    sys.exit ()
##
##print ("       Updating Building/Trailer Only - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
##write_log("       Updating Building/Trailer Only - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
write_log("\n Updating Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)

try:
    # Delete rows from Tax Parcels - Air - CRAW_INTERNAL
    arcpy.DeleteRows_management(AIRPARCELS_INTERNAL)
except:
    print ("\n Unable to delete rows from Tax Parcels - Air - CRAW_INTERNAL")
    write_log("Unable to delete rows from Tax Parcels - Air - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on delete rows from Tax Parcels - Air - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT
    arcpy.management.Append(AIRPARCELS_AUTOWKSP, AIRPARCELS_INTERNAL, "NO_TEST", r'PID "PID Number" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',PID,-1,-1;CAMA_PIN "MBLU (Map Block Lot Unit) #" true true false 100 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',CAMA_PIN,0,100;Type "Type of air parcel" true true false 255 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',Type,0,255;Elevation "Elevation (in feet)" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',Elevation,-1,-1;Building "Building designation (if needed)" true true false 255 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',Building,0,255;Floor "Floor (if needed)" true true false 100 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',Floor,0,100;Unit "Unit (if needed)" true true false 100 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',Unit,0,100;Landex_URL_Choice "Landex URL (choose one)" true true false 100 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',Landex_URL_Choice,0,100;created_user "created_user" true true false 255 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',created_user,0,255;created_date "created_date" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',created_date,-1,-1;last_edited_user "last_edited_user" true true false 255 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',last_edited_user,0,255;last_edited_date "last_edited_date" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',last_edited_date,-1,-1;REM_MNC "REM_MNC" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MNC,-1,-1;REM_PID "PID Number" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PID,-1,-1;REM_PIN "UPI Number" true true false 35 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PIN,0,35;REM_OWN_NAME "Owner Name" true true false 85 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_OWN_NAME,0,85;REM_PRCL_LOCN "Parcel Location" true true false 50 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PRCL_LOCN,0,50;REM_PRCL_LOCN_CITY "Parcel Location City" true true false 18 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PRCL_LOCN_CITY,0,18;REM_PRCL_LOCN_STT "Parcel Location State" true true false 2 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PRCL_LOCN_STT,0,2;REM_PRCL_LOCN_ZIP "Parcel Location Zipcode" true true false 12 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PRCL_LOCN_ZIP,0,12;REM_ALT_PRCL_ID "Old IBM Number" true true false 35 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_ALT_PRCL_ID,0,35;REM_PRCL_STATUS_DATE "Parcel Status date - CAMA Software" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PRCL_STATUS_DATE,-1,-1;REM_MBLU_MAP "Map" true true false 7 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_MAP,0,7;REM_MBLU_MAP_CUT "Map Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_MAP_CUT,0,3;REM_MBLU_BLOCK "Block" true true false 7 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_BLOCK,0,7;REM_MBLU_BLOCK_CUT "Block Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_BLOCK_CUT,0,3;REM_MBLU_LOT "Lot" true true false 7 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_LOT,0,7;REM_MBLU_LOT_CUT "Lot Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_LOT_CUT,0,3;REM_MBLU_UNIT "Unit" true true false 7 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_UNIT,0,7;REM_MBLU_UNIT_CUT "Unit Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_MBLU_UNIT_CUT,0,3;REM_STATUS_DATE "Status Date - CAMA software" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_STATUS_DATE,-1,-1;REM_INET_SUPPRESS "Internet Suppression" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',REM_INET_SUPPRESS,-1,-1;REM_IS_CONDO_MAIN "Is Condo Main Parcel" true true false 2 Short 0 5,First,#,'+AIRPARCELS_AUTOWKSP+',REM_IS_CONDO_MAIN,-1,-1;REM_CMPLX_NAME "Complex Name" true true false 30 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_CMPLX_NAME,0,30;REM_BLDG_NAME "Acreage and Description" true true false 60 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_BLDG_NAME,0,60;REM_USE_CODE "Use Code" true true false 4 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_USE_CODE,0,4;REM_LEGAL_AREA "Legal Area" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',REM_LEGAL_AREA,-1,-1;REM_LAST_UPDATE "Last Update - CAMA software" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_LAST_UPDATE,-1,-1;REM_USRFLD "6 digit PID" true true false 6 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_USRFLD,0,6;REM_USRFLD_DESC "Control Number" true true false 40 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_USRFLD_DESC,0,40;PID_TEXT "PID Text format" true true false 15 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PID_TEXT,0,15;REM_PARCEL_STATUS "Parcel Status in CAMA" true true false 1 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',REM_PARCEL_STATUS,0,1;LND_USE_CODE "Land Use Code" true true false 4 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',LND_USE_CODE,0,4;LND_USE_DESC "Land Use Description" true true false 40 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',LND_USE_DESC,0,40;LND_DSTRCT "District Number" true true false 6 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',LND_DSTRCT,0,6;MUNI_NAME "Municipality Name" true true false 75 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MUNI_NAME,0,75;PRC_PF_LOCN "School District Code" true true false 15 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_PF_LOCN,0,15;PRC_PF_LOCN_DESC "School District" true true false 50 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_PF_LOCN_DESC,0,50;PRC_USRFLD_09 "User Field 9 - Not Used" true true false 30 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_USRFLD_09,0,30;PRC_USRFLD_10 "User Field 10 - Not Used" true true false 30 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_USRFLD_10,0,30;PRC_TTL_ASSESS_BLDG "Total Building Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_TTL_ASSESS_BLDG,-1,-1;PRC_TTL_ASSESS_IMPROVEMENTS "Total Improvements Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_TTL_ASSESS_IMPROVEMENTS,-1,-1;PRC_TTL_ASSESS_LND "Total Land Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_TTL_ASSESS_LND,-1,-1;PRC_TTL_ASSESS_OB "Total Out Building Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_TTL_ASSESS_OB,-1,-1;PRC_VALUE "Parcel Value" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_VALUE,-1,-1;PRC_CMPLX_PID "Complex PID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_CMPLX_PID,-1,-1;PRC_CMPLX_DESC "Complex Description" true true false 30 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_CMPLX_DESC,0,30;PRC_CENSUS "Census - Not Used" true true false 20 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_CENSUS,0,20;PRC_TTL_MRKT_ASSESS "Total Market Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_TTL_MRKT_ASSESS,-1,-1;PRC_TTL_ASSESS "Total Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',PRC_TTL_ASSESS,-1,-1;OWN_ID "OWN_ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',OWN_ID,-1,-1;OWN_NAME1 "OWN_NAME1" true true false 85 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',OWN_NAME1,0,85;OWN_NAME2 "OWN_NAME2" true true false 85 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',OWN_NAME2,0,85;ROW_PID "ROW_PID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_PID,-1,-1;ROW_OWN_ID "ROW_OWN_ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_OWN_ID,-1,-1;ROW_LINE_NUM "ROW_LINE_NUM" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_LINE_NUM,-1,-1;ROW_OWN_PCT "ROW_OWN_PCT" true true false 2 Short 0 5,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_OWN_PCT,-1,-1;ROW_PRIMARY "ROW_PRIMARY" true true false 2 Short 0 5,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_PRIMARY,-1,-1;ROW_CREATE_DATE "ROW_CREATE_DATE" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_CREATE_DATE,-1,-1;ROW_MAD_ID "ROW_MAD_ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_MAD_ID,-1,-1;ROW_MAD_ISPRIMARY "ROW_MAD_ISPRIMARY" true true false 2 Short 0 5,First,#,'+AIRPARCELS_AUTOWKSP+',ROW_MAD_ISPRIMARY,-1,-1;OWN_LINE "OWN_LINE" true true false 255 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',OWN_LINE,0,255;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_NAME1,0,85;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_NAME2,0,85;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_ADDR1,0,50;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_CITY,0,30;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_STATE,0,20;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_ZIP,0,20;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_MAIL_ADDR2,0,50;MAD_ID "Mailing Address VISION ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',MAD_ID,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_PID,-1,-1;SLH_LINE_NUM "Sales History Line Number" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_LINE_NUM,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_BOOK,0,15;SLH_PAGE "Deed Page" true true false 15 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_PAGE,0,15;SLH_PRICE "Sale Price" true true false 8 Double 8 38,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_PRICE,-1,-1;SLH_CURRENT_OWNER "Sales History Current Owner Designation" true true false 2 Short 0 5,First,#,'+AIRPARCELS_AUTOWKSP+',SLH_CURRENT_OWNER,-1,-1;REM_INET_SUPPRESS_1 "Internet Suppression" true true false 4 Long 0 10,First,#,'+AIRPARCELS_AUTOWKSP+',REM_INET_SUPPRESS_1,-1,-1;LANDEX_URL "Landex URL" true true false 600 Text 0 0,First,#,'+AIRPARCELS_AUTOWKSP+',LANDEX_URL,0,600;GlobalID "GlobalID" false false true 38 GlobalID 0 0,First,#', '', '')
    AirParcels_Internal_result = arcpy.GetCount_management(AIRPARCELS_INTERNAL)
    print (('{} has {} records'.format(AIRPARCELS_INTERNAL,  AirParcels_Internal_result[0])))
    write_log('{} has {} records'.format(AIRPARCELS_INTERNAL,  AirParcels_Internal_result[0]), logfile)
except:
    print ("\n Unable to append Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT")
    write_log("Unable to append Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT", logfile)
    logging.exception('Got exception on append Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Tax Parcels - Air - CRAW_INTERNAL from AUTOWORKSPACE\ASSESSMENT completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

print ("\n Updating Tax Parcels - Air - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
write_log("\n Updating Tax Parcels - Air - PUBLIC_WEB from CRAW_INTERNAL - filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0", logfile)

try:
    # Delete rows from Tax Parcels - Air - PUBLIC_WEB
    arcpy.DeleteRows_management(AIRPARCELS_WEB)
except:
    print ("\n Unable to delete rows from Tax Parcels - Air - PUBLIC_WEB")
    write_log("Unable to delete rows from Tax Parcels - Air - PUBLIC_WEB", logfile)
    logging.exception('Got exception on delete rows from Tax Parcels - Air - PUBLIC_WEB logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

try:
    # Append Tax Parcels - Air - PUBLIC_WEB from filtered out filtering out REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0 of Tax Parcels - Air - CRAW_INTERNAL 
    arcpy.management.Append(AIRPARCELS_INTERNAL, AIRPARCELS_WEB, "NO_TEST", r'PID "PID Number" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',PID,-1,-1;CAMA_PIN "MBLU (Map Block Lot Unit) #" true true false 100 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',CAMA_PIN,0,100;Type "Type of air parcel" true true false 255 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',Type,0,255;Elevation "Elevation (in feet)" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',Elevation,-1,-1;Building "Building designation (if needed)" true true false 255 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',Building,0,255;Floor "Floor (if needed)" true true false 100 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',Floor,0,100;Unit "Unit (if needed)" true true false 100 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',Unit,0,100;Landex_URL_Choice "Landex URL (choose one)" true true false 100 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',Landex_URL_Choice,0,100;created_user "created_user" true true false 255 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',created_user,0,255;created_date "created_date" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',created_date,-1,-1;last_edited_user "last_edited_user" true true false 255 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',last_edited_user,0,255;last_edited_date "last_edited_date" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',last_edited_date,-1,-1;REM_MNC "REM_MNC" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',REM_MNC,-1,-1;REM_PID "PID Number" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',REM_PID,-1,-1;REM_PIN "UPI Number" true true false 35 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PIN,0,35;REM_OWN_NAME "Owner Name" true true false 85 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_OWN_NAME,0,85;REM_PRCL_LOCN "Parcel Location" true true false 50 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PRCL_LOCN,0,50;REM_PRCL_LOCN_CITY "Parcel Location City" true true false 18 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PRCL_LOCN_CITY,0,18;REM_PRCL_LOCN_STT "Parcel Location State" true true false 2 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PRCL_LOCN_STT,0,2;REM_PRCL_LOCN_ZIP "Parcel Location Zipcode" true true false 12 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PRCL_LOCN_ZIP,0,12;REM_ALT_PRCL_ID "Old IBM Number" true true false 35 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_ALT_PRCL_ID,0,35;REM_PRCL_STATUS_DATE "Parcel Status date - CAMA Software" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PRCL_STATUS_DATE,-1,-1;REM_MBLU_MAP "Map" true true false 7 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_MAP,0,7;REM_MBLU_MAP_CUT "Map Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_MAP_CUT,0,3;REM_MBLU_BLOCK "Block" true true false 7 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_BLOCK,0,7;REM_MBLU_BLOCK_CUT "Block Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_BLOCK_CUT,0,3;REM_MBLU_LOT "Lot" true true false 7 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_LOT,0,7;REM_MBLU_LOT_CUT "Lot Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_LOT_CUT,0,3;REM_MBLU_UNIT "Unit" true true false 7 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_UNIT,0,7;REM_MBLU_UNIT_CUT "Unit Cut - Not Used" true true false 3 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_MBLU_UNIT_CUT,0,3;REM_STATUS_DATE "Status Date - CAMA software" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_STATUS_DATE,-1,-1;REM_INET_SUPPRESS "Internet Suppression" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',REM_INET_SUPPRESS,-1,-1;REM_IS_CONDO_MAIN "Is Condo Main Parcel" true true false 2 Short 0 5,First,#,'+AIRPARCELS_INTERNAL+',REM_IS_CONDO_MAIN,-1,-1;REM_CMPLX_NAME "Complex Name" true true false 30 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_CMPLX_NAME,0,30;REM_BLDG_NAME "Acreage and Description" true true false 60 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_BLDG_NAME,0,60;REM_USE_CODE "Use Code" true true false 4 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_USE_CODE,0,4;REM_LEGAL_AREA "Legal Area" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',REM_LEGAL_AREA,-1,-1;REM_LAST_UPDATE "Last Update - CAMA software" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_LAST_UPDATE,-1,-1;REM_USRFLD "6 digit PID" true true false 6 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_USRFLD,0,6;REM_USRFLD_DESC "Control Number" true true false 40 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_USRFLD_DESC,0,40;PID_TEXT "PID Text format" true true false 15 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PID_TEXT,0,15;REM_PARCEL_STATUS "Parcel Status in CAMA" true true false 1 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',REM_PARCEL_STATUS,0,1;LND_USE_CODE "Land Use Code" true true false 4 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',LND_USE_CODE,0,4;LND_USE_DESC "Land Use Description" true true false 40 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',LND_USE_DESC,0,40;LND_DSTRCT "District Number" true true false 6 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',LND_DSTRCT,0,6;MUNI_NAME "Municipality Name" true true false 75 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MUNI_NAME,0,75;PRC_PF_LOCN "School District Code" true true false 15 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PRC_PF_LOCN,0,15;PRC_PF_LOCN_DESC "School District" true true false 50 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PRC_PF_LOCN_DESC,0,50;PRC_USRFLD_09 "User Field 9 - Not Used" true true false 30 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PRC_USRFLD_09,0,30;PRC_USRFLD_10 "User Field 10 - Not Used" true true false 30 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PRC_USRFLD_10,0,30;PRC_TTL_ASSESS_BLDG "Total Building Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_TTL_ASSESS_BLDG,-1,-1;PRC_TTL_ASSESS_IMPROVEMENTS "Total Improvements Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_TTL_ASSESS_IMPROVEMENTS,-1,-1;PRC_TTL_ASSESS_LND "Total Land Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_TTL_ASSESS_LND,-1,-1;PRC_TTL_ASSESS_OB "Total Out Building Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_TTL_ASSESS_OB,-1,-1;PRC_VALUE "Parcel Value" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_VALUE,-1,-1;PRC_CMPLX_PID "Complex PID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',PRC_CMPLX_PID,-1,-1;PRC_CMPLX_DESC "Complex Description" true true false 30 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PRC_CMPLX_DESC,0,30;PRC_CENSUS "Census - Not Used" true true false 20 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',PRC_CENSUS,0,20;PRC_TTL_MRKT_ASSESS "Total Market Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_TTL_MRKT_ASSESS,-1,-1;PRC_TTL_ASSESS "Total Assessment" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',PRC_TTL_ASSESS,-1,-1;OWN_ID "OWN_ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',OWN_ID,-1,-1;OWN_NAME1 "OWN_NAME1" true true false 85 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',OWN_NAME1,0,85;OWN_NAME2 "OWN_NAME2" true true false 85 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',OWN_NAME2,0,85;ROW_PID "ROW_PID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',ROW_PID,-1,-1;ROW_OWN_ID "ROW_OWN_ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',ROW_OWN_ID,-1,-1;ROW_LINE_NUM "ROW_LINE_NUM" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',ROW_LINE_NUM,-1,-1;ROW_OWN_PCT "ROW_OWN_PCT" true true false 2 Short 0 5,First,#,'+AIRPARCELS_INTERNAL+',ROW_OWN_PCT,-1,-1;ROW_PRIMARY "ROW_PRIMARY" true true false 2 Short 0 5,First,#,'+AIRPARCELS_INTERNAL+',ROW_PRIMARY,-1,-1;ROW_CREATE_DATE "ROW_CREATE_DATE" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',ROW_CREATE_DATE,-1,-1;ROW_MAD_ID "ROW_MAD_ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',ROW_MAD_ID,-1,-1;ROW_MAD_ISPRIMARY "ROW_MAD_ISPRIMARY" true true false 2 Short 0 5,First,#,'+AIRPARCELS_INTERNAL+',ROW_MAD_ISPRIMARY,-1,-1;OWN_LINE "OWN_LINE" true true false 255 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',OWN_LINE,0,255;MAD_MAIL_NAME1 "Tax Bill Mailing Address Name 1" true true false 85 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_NAME1,0,85;MAD_MAIL_NAME2 "Tax Bill Mailing Address Name 2" true true false 85 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_NAME2,0,85;MAD_MAIL_ADDR1 "Tax Bill Mailing Address 1" true true false 50 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_ADDR1,0,50;MAD_MAIL_CITY "Tax Bill Mailing Address City" true true false 30 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_CITY,0,30;MAD_MAIL_STATE "Tax Bill Mailing Address State" true true false 20 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_STATE,0,20;MAD_MAIL_ZIP "Tax Bill Mailing Address Zipcode" true true false 20 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_ZIP,0,20;MAD_MAIL_ADDR2 "Tax Bill Mailing Address 2" true true false 50 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',MAD_MAIL_ADDR2,0,50;MAD_ID "Mailing Address VISION ID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',MAD_ID,-1,-1;SLH_PID "Sales History PID" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',SLH_PID,-1,-1;SLH_LINE_NUM "Sales History Line Number" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',SLH_LINE_NUM,-1,-1;SLH_SALE_DATE "Sale Date" true true false 8 Date 0 0,First,#,'+AIRPARCELS_INTERNAL+',SLH_SALE_DATE,-1,-1;SLH_BOOK "Deed Book / Instrument Number" true true false 15 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',SLH_BOOK,0,15;SLH_PAGE "Deed Page" true true false 15 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',SLH_PAGE,0,15;SLH_PRICE "Sale Price" true true false 8 Double 8 38,First,#,'+AIRPARCELS_INTERNAL+',SLH_PRICE,-1,-1;SLH_CURRENT_OWNER "Sales History Current Owner Designation" true true false 2 Short 0 5,First,#,'+AIRPARCELS_INTERNAL+',SLH_CURRENT_OWNER,-1,-1;REM_INET_SUPPRESS_1 "Internet Suppression" true true false 4 Long 0 10,First,#,'+AIRPARCELS_INTERNAL+',REM_INET_SUPPRESS_1,-1,-1;LANDEX_URL "Landex URL" true true false 600 Text 0 0,First,#,'+AIRPARCELS_INTERNAL+',LANDEX_URL,0,600;GlobalID "GlobalID" false false true 38 GlobalID 0 0,First,#,'+AIRPARCELS_INTERNAL+',GlobalID,-1,-1', '', "REM_INET_SUPPRESS IS NULL OR REM_INET_SUPPRESS = 0")
    AirParcels_Web_result = arcpy.GetCount_management(AIRPARCELS_WEB)
    print (('{} has {} records'.format(AIRPARCELS_WEB,  AirParcels_Web_result[0])))
    write_log('{} has {} records'.format(AIRPARCELS_WEB,  AirParcels_Web_result[0]), logfile)
except:
    print ("\n Unable to append Tax Parcels - Air - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL")
    write_log("Unable to append Tax Parcels - Air - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL", logfile)
    logging.exception('Got exception on append Tax Parcels - Air - PUBLIC_WEB from filtered layer of Building/Trailer Only - CRAW_INTERNAL logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()

print ("       Updating Tax Parcels - Air - PUBLIC_WEB from filtered layer of Tax Parcels - Air - CRAW_INTERNAL completed at " + time.strftime("%I:%M:%S %p", time.localtime()))
write_log("       Updating Tax Parcels - Air - PUBLIC_WEB from filtered layer of Tax Parcels - Air - CRAW_INTERNAL completed at "+time.strftime("%I:%M:%S %p", time.localtime()), logfile)

try:
    # Delete VISION_OWNER_TBL_WEBTemp
    arcpy.Delete_management(VISION_OWNER_TBL_WEBTemp)
except:
    print ("\n Unable to Delete VISION_OWNER_TBL_View & VISION_OWNER_Not_INET_SUPRESSED")
    write_log("Unable to Delete VISION_OWNER_TBL_View & VISION_OWNER_Not_INET_SUPRESSED", logfile)
    logging.exception('Got exception on Delete VISION_OWNER_TBL_View & VISION_OWNER_Not_INET_SUPRESSED logged at:' + time.strftime("%I:%M:%S %p", time.localtime()))
    raise
    sys.exit ()  

end_time = time.strftime("%I:%M:%S %p", time.localtime())
elapsed_time = time.time() - start_time

print ("==============================================================")
print (("\n ALL LAND RECORDS UPDATES ARE COMPLETED: " + str(Day) + " " + str(end_time)))
write_log("\n ALL LAND RECORDS UPDATES ARE COMPLETED: " + str(Day) + " " + str(end_time), logfile)

print ("Elapsed time: " + time.strftime("%H:%M:%S", time.gmtime(elapsed_time))+" // Program completed: "  +time.strftime("%I:%M:%S %p", time.localtime()))
write_log("Elapsed time: " + (time.strftime("%H:%M:%S", time.gmtime(elapsed_time))+" // Program completed: " +time.strftime("%I:%M:%S %p", time.localtime())), logfile)
print ("===========================================================")
write_log("===========================================================",logfile)


write_log("\n           +#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#+#", logfile)
del arcpy
sys.exit()
